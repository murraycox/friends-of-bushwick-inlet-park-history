import{s as $e,R as ne,S as ie,b as U,f as N,q as E,T as Q,i as A,h as H,n as ze,U as xe,V as yt,y as wt,w as x,r as ft,t as Oe,d as ke,W as Ne,F as Le,j as Ie,C as Un,X as ci,e as ve,a as Re,c as me,g as Ve,v as St,Y as Yn,z as pe,H as Zt,p as Wt,k as pi}from"../chunks/scheduler.BwjH7zTA.js";import{S as et,i as tt,t as $,g as nt,a as re,e as it,c as Me,b as Se,m as Ee,d as be}from"../chunks/index.BU9U6aD7.js";import{b as Kt,g as hi}from"../chunks/entry.Bt7RQuqs.js";import{p as gi}from"../chunks/stores.ByA6DIaj.js";import{c as oe,d as vi,i as Qt,T as Et,e as bt,f as de,b as Ot,g as mi,N as di,s as He,a as _i}from"../chunks/story.CClHyzpZ.js";class Ce{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const l=n[r],s=t+l,o=Math.abs(t)<Math.abs(l)?t-(s-l):l-(s-t);o&&(n[i++]=o),t=s}return n[i]=t,this._n=i+1,this}valueOf(){const t=this._partials;let n=this._n,i,r,l,s=0;if(n>0){for(s=t[--n];n>0&&(i=s,r=t[--n],s=i+r,l=r-(s-i),!l););n>0&&(l<0&&t[n-1]<0||l>0&&t[n-1]>0)&&(r=l*2,i=s+r,r==i-s&&(s=i))}return s}}function*yi(e){for(const t of e)yield*t}function Xn(e){return Array.from(yi(e))}function wi(e){let t;for(;t=e.sourceEvent;)e=t;return e}function De(e,t){if(e=wi(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,i=i.matrixTransform(t.getScreenCTM().inverse()),[i.x,i.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}}return[e.pageX,e.pageY]}const Ct={capture:!0,passive:!1};function Tt(e){e.preventDefault(),e.stopImmediatePropagation()}function Mi(e){var t=e.document.documentElement,n=oe(e).on("dragstart.drag",Tt,Ct);"onselectstart"in t?n.on("selectstart.drag",Tt,Ct):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Si(e,t){var n=e.document.documentElement,i=oe(e).on("dragstart.drag",null);t&&(i.on("click.drag",Tt,Ct),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var Ei=1e-12;function nn(e){return((e=Math.exp(e))+1/e)/2}function bi(e){return((e=Math.exp(e))-1/e)/2}function Oi(e){return((e=Math.exp(2*e))-1)/(e+1)}const ki=function e(t,n,i){function r(l,s){var o=l[0],u=l[1],c=l[2],a=s[0],f=s[1],p=s[2],h=a-o,d=f-u,O=h*h+d*d,b,M;if(O<Ei)M=Math.log(p/c)/t,b=function(w){return[o+w*h,u+w*d,c*Math.exp(t*w*M)]};else{var k=Math.sqrt(O),_=(p*p-c*c+i*O)/(2*c*n*k),I=(p*p-c*c-i*O)/(2*p*n*k),y=Math.log(Math.sqrt(_*_+1)-_),D=Math.log(Math.sqrt(I*I+1)-I);M=(D-y)/t,b=function(w){var P=w*M,L=nn(y),j=c/(n*k)*(L*Oi(t*P+y)-bi(y));return[o+j*h,u+j*d,c*L/nn(t*P+y)]}}return b.duration=M*1e3*t/Math.SQRT2,b}return r.rho=function(l){var s=Math.max(.001,+l),o=s*s,u=o*o;return e(s,o,u)},r}(Math.SQRT2,2,4);function Ii(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);if(!(e.status===204||e.status===205))return e.json()}function Gn(e,t){return fetch(e,t).then(Ii)}var Y=1e-6,Di=1e-12,R=Math.PI,le=R/2,rn=R/4,ae=R*2,se=180/R,K=R/180,B=Math.abs,Bn=Math.atan,Ze=Math.atan2,Z=Math.cos,Ni=Math.exp,zi=Math.log,W=Math.sin,Ci=Math.sign||function(e){return e>0?1:e<0?-1:0},Fe=Math.sqrt,Ti=Math.tan;function Fi(e){return e>1?0:e<-1?R:Math.acos(e)}function We(e){return e>1?le:e<-1?-le:Math.asin(e)}function fe(){}function ct(e,t){e&&ln.hasOwnProperty(e.type)&&ln[e.type](e,t)}var on={Feature:function(e,t){ct(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,i=-1,r=n.length;++i<r;)ct(n[i].geometry,t)}},ln={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)e=n[i],t.point(e[0],e[1],e[2])},LineString:function(e,t){Ft(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)Ft(n[i],t,0)},Polygon:function(e,t){sn(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,i=-1,r=n.length;++i<r;)sn(n[i],t)},GeometryCollection:function(e,t){for(var n=e.geometries,i=-1,r=n.length;++i<r;)ct(n[i],t)}};function Ft(e,t,n){var i=-1,r=e.length-n,l;for(t.lineStart();++i<r;)l=e[i],t.point(l[0],l[1],l[2]);t.lineEnd()}function sn(e,t){var n=-1,i=e.length;for(t.polygonStart();++n<i;)Ft(e[n],t,1);t.polygonEnd()}function Pe(e,t){e&&on.hasOwnProperty(e.type)?on[e.type](e,t):ct(e,t)}function Pt(e){return[Ze(e[1],e[0]),We(e[2])]}function je(e){var t=e[0],n=e[1],i=Z(n);return[i*Z(t),i*W(t),W(n)]}function rt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function pt(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function kt(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function ot(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Jt(e){var t=Fe(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function Lt(e,t){function n(i,r){return i=e(i,r),t(i[0],i[1])}return e.invert&&t.invert&&(n.invert=function(i,r){return i=t.invert(i,r),i&&e.invert(i[0],i[1])}),n}function Rt(e,t){return B(e)>R&&(e-=Math.round(e/ae)*ae),[e,t]}Rt.invert=Rt;function qn(e,t,n){return(e%=ae)?t||n?Lt(un(e),fn(t,n)):un(e):t||n?fn(t,n):Rt}function an(e){return function(t,n){return t+=e,B(t)>R&&(t-=Math.round(t/ae)*ae),[t,n]}}function un(e){var t=an(e);return t.invert=an(-e),t}function fn(e,t){var n=Z(e),i=W(e),r=Z(t),l=W(t);function s(o,u){var c=Z(u),a=Z(o)*c,f=W(o)*c,p=W(u),h=p*n+a*i;return[Ze(f*r-h*l,a*n-p*i),We(h*r+f*l)]}return s.invert=function(o,u){var c=Z(u),a=Z(o)*c,f=W(o)*c,p=W(u),h=p*r-f*l;return[Ze(f*r+p*l,a*n+h*i),We(h*n-a*i)]},s}function Pi(e){e=qn(e[0]*K,e[1]*K,e.length>2?e[2]*K:0);function t(n){return n=e(n[0]*K,n[1]*K),n[0]*=se,n[1]*=se,n}return t.invert=function(n){return n=e.invert(n[0]*K,n[1]*K),n[0]*=se,n[1]*=se,n},t}function Ji(e,t,n,i,r,l){if(n){var s=Z(t),o=W(t),u=i*n;r==null?(r=t+i*ae,l=t-u/2):(r=cn(s,r),l=cn(s,l),(i>0?r<l:r>l)&&(r+=i*ae));for(var c,a=r;i>0?a>l:a<l;a-=u)c=Pt([s,-o*Z(a),-o*W(a)]),e.point(c[0],c[1])}}function cn(e,t){t=je(t),t[0]-=e,Jt(t);var n=Fi(-t[1]);return((-t[2]<0?-n:n)+ae-Y)%ae}function Hn(){var e=[],t;return{point:function(n,i,r){t.push([n,i,r])},lineStart:function(){e.push(t=[])},lineEnd:fe,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function ut(e,t){return B(e[0]-t[0])<Y&&B(e[1]-t[1])<Y}function lt(e,t,n,i){this.x=e,this.z=t,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function Zn(e,t,n,i,r){var l=[],s=[],o,u;if(e.forEach(function(d){if(!((O=d.length-1)<=0)){var O,b=d[0],M=d[O],k;if(ut(b,M)){if(!b[2]&&!M[2]){for(r.lineStart(),o=0;o<O;++o)r.point((b=d[o])[0],b[1]);r.lineEnd();return}M[0]+=2*Y}l.push(k=new lt(b,d,null,!0)),s.push(k.o=new lt(b,null,k,!1)),l.push(k=new lt(M,d,null,!1)),s.push(k.o=new lt(M,null,k,!0))}}),!!l.length){for(s.sort(t),pn(l),pn(s),o=0,u=s.length;o<u;++o)s[o].e=n=!n;for(var c=l[0],a,f;;){for(var p=c,h=!0;p.v;)if((p=p.n)===c)return;a=p.z,r.lineStart();do{if(p.v=p.o.v=!0,p.e){if(h)for(o=0,u=a.length;o<u;++o)r.point((f=a[o])[0],f[1]);else i(p.x,p.n.x,1,r);p=p.n}else{if(h)for(a=p.p.z,o=a.length-1;o>=0;--o)r.point((f=a[o])[0],f[1]);else i(p.x,p.p.x,-1,r);p=p.p}p=p.o,a=p.z,h=!h}while(!p.v);r.lineEnd()}}}function pn(e){if(t=e.length){for(var t,n=0,i=e[0],r;++n<t;)i.n=r=e[n],r.p=i,i=r;i.n=r=e[0],r.p=i}}function It(e){return B(e[0])<=R?e[0]:Ci(e[0])*((B(e[0])+R)%ae-R)}function Li(e,t){var n=It(t),i=t[1],r=W(i),l=[W(n),-Z(n),0],s=0,o=0,u=new Ce;r===1?i=le+Y:r===-1&&(i=-le-Y);for(var c=0,a=e.length;c<a;++c)if(p=(f=e[c]).length)for(var f,p,h=f[p-1],d=It(h),O=h[1]/2+rn,b=W(O),M=Z(O),k=0;k<p;++k,d=I,b=D,M=w,h=_){var _=f[k],I=It(_),y=_[1]/2+rn,D=W(y),w=Z(y),P=I-d,L=P>=0?1:-1,j=L*P,T=j>R,ee=b*D;if(u.add(Ze(ee*L*W(j),M*w+ee*Z(j))),s+=T?P+L*ae:P,T^d>=n^I>=n){var X=pt(je(h),je(_));Jt(X);var v=pt(l,X);Jt(v);var m=(T^P>=0?-1:1)*We(v[2]);(i>m||i===m&&(X[0]||X[1]))&&(o+=T^P>=0?1:-1)}}return(s<-Y||s<Y&&u<-Di)^o&1}function Wn(e,t,n,i){return function(r){var l=t(r),s=Hn(),o=t(s),u=!1,c,a,f,p={point:h,lineStart:O,lineEnd:b,polygonStart:function(){p.point=M,p.lineStart=k,p.lineEnd=_,a=[],c=[]},polygonEnd:function(){p.point=h,p.lineStart=O,p.lineEnd=b,a=Xn(a);var I=Li(c,i);a.length?(u||(r.polygonStart(),u=!0),Zn(a,Vi,I,n,r)):I&&(u||(r.polygonStart(),u=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),u&&(r.polygonEnd(),u=!1),a=c=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function h(I,y){e(I,y)&&r.point(I,y)}function d(I,y){l.point(I,y)}function O(){p.point=d,l.lineStart()}function b(){p.point=h,l.lineEnd()}function M(I,y){f.push([I,y]),o.point(I,y)}function k(){o.lineStart(),f=[]}function _(){M(f[0][0],f[0][1]),o.lineEnd();var I=o.clean(),y=s.result(),D,w=y.length,P,L,j;if(f.pop(),c.push(f),f=null,!!w){if(I&1){if(L=y[0],(P=L.length-1)>0){for(u||(r.polygonStart(),u=!0),r.lineStart(),D=0;D<P;++D)r.point((j=L[D])[0],j[1]);r.lineEnd()}return}w>1&&I&2&&y.push(y.pop().concat(y.shift())),a.push(y.filter(Ri))}}return p}}function Ri(e){return e.length>1}function Vi(e,t){return((e=e.x)[0]<0?e[1]-le-Y:le-e[1])-((t=t.x)[0]<0?t[1]-le-Y:le-t[1])}const hn=Wn(function(){return!0},ji,Ui,[-R,-le]);function ji(e){var t=NaN,n=NaN,i=NaN,r;return{lineStart:function(){e.lineStart(),r=1},point:function(l,s){var o=l>0?R:-R,u=B(l-t);B(u-R)<Y?(e.point(t,n=(n+s)/2>0?le:-le),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(o,n),e.point(l,n),r=0):i!==o&&u>=R&&(B(t-i)<Y&&(t-=i*Y),B(l-o)<Y&&(l-=o*Y),n=Ai(t,n,l,s),e.point(i,n),e.lineEnd(),e.lineStart(),e.point(o,n),r=0),e.point(t=l,n=s),i=o},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-r}}}function Ai(e,t,n,i){var r,l,s=W(e-n);return B(s)>Y?Bn((W(t)*(l=Z(i))*W(n)-W(i)*(r=Z(t))*W(e))/(r*l*s)):(t+i)/2}function Ui(e,t,n,i){var r;if(e==null)r=n*le,i.point(-R,r),i.point(0,r),i.point(R,r),i.point(R,0),i.point(R,-r),i.point(0,-r),i.point(-R,-r),i.point(-R,0),i.point(-R,r);else if(B(e[0]-t[0])>Y){var l=e[0]<t[0]?R:-R;r=n*l/2,i.point(-l,r),i.point(0,r),i.point(l,r)}else i.point(t[0],t[1])}function Yi(e){var t=Z(e),n=2*K,i=t>0,r=B(t)>Y;function l(a,f,p,h){Ji(h,e,n,p,a,f)}function s(a,f){return Z(a)*Z(f)>t}function o(a){var f,p,h,d,O;return{lineStart:function(){d=h=!1,O=1},point:function(b,M){var k=[b,M],_,I=s(b,M),y=i?I?0:c(b,M):I?c(b+(b<0?R:-R),M):0;if(!f&&(d=h=I)&&a.lineStart(),I!==h&&(_=u(f,k),(!_||ut(f,_)||ut(k,_))&&(k[2]=1)),I!==h)O=0,I?(a.lineStart(),_=u(k,f),a.point(_[0],_[1])):(_=u(f,k),a.point(_[0],_[1],2),a.lineEnd()),f=_;else if(r&&f&&i^I){var D;!(y&p)&&(D=u(k,f,!0))&&(O=0,i?(a.lineStart(),a.point(D[0][0],D[0][1]),a.point(D[1][0],D[1][1]),a.lineEnd()):(a.point(D[1][0],D[1][1]),a.lineEnd(),a.lineStart(),a.point(D[0][0],D[0][1],3)))}I&&(!f||!ut(f,k))&&a.point(k[0],k[1]),f=k,h=I,p=y},lineEnd:function(){h&&a.lineEnd(),f=null},clean:function(){return O|(d&&h)<<1}}}function u(a,f,p){var h=je(a),d=je(f),O=[1,0,0],b=pt(h,d),M=rt(b,b),k=b[0],_=M-k*k;if(!_)return!p&&a;var I=t*M/_,y=-t*k/_,D=pt(O,b),w=ot(O,I),P=ot(b,y);kt(w,P);var L=D,j=rt(w,L),T=rt(L,L),ee=j*j-T*(rt(w,w)-1);if(!(ee<0)){var X=Fe(ee),v=ot(L,(-j-X)/T);if(kt(v,w),v=Pt(v),!p)return v;var m=a[0],g=f[0],S=a[1],z=f[1],C;g<m&&(C=m,m=g,g=C);var F=g-m,J=B(F-R)<Y,V=J||F<Y;if(!J&&z<S&&(C=S,S=z,z=C),V?J?S+z>0^v[1]<(B(v[0]-m)<Y?S:z):S<=v[1]&&v[1]<=z:F>R^(m<=v[0]&&v[0]<=g)){var G=ot(L,(-j+X)/T);return kt(G,w),[v,Pt(G)]}}}function c(a,f){var p=i?e:R-e,h=0;return a<-p?h|=1:a>p&&(h|=2),f<-p?h|=4:f>p&&(h|=8),h}return Wn(s,o,l,i?[0,-e]:[-R,e-R])}function Xi(e,t,n,i,r,l){var s=e[0],o=e[1],u=t[0],c=t[1],a=0,f=1,p=u-s,h=c-o,d;if(d=n-s,!(!p&&d>0)){if(d/=p,p<0){if(d<a)return;d<f&&(f=d)}else if(p>0){if(d>f)return;d>a&&(a=d)}if(d=r-s,!(!p&&d<0)){if(d/=p,p<0){if(d>f)return;d>a&&(a=d)}else if(p>0){if(d<a)return;d<f&&(f=d)}if(d=i-o,!(!h&&d>0)){if(d/=h,h<0){if(d<a)return;d<f&&(f=d)}else if(h>0){if(d>f)return;d>a&&(a=d)}if(d=l-o,!(!h&&d<0)){if(d/=h,h<0){if(d>f)return;d>a&&(a=d)}else if(h>0){if(d<a)return;d<f&&(f=d)}return a>0&&(e[0]=s+a*p,e[1]=o+a*h),f<1&&(t[0]=s+f*p,t[1]=o+f*h),!0}}}}}var Ye=1e9,st=-Ye;function Gi(e,t,n,i){function r(c,a){return e<=c&&c<=n&&t<=a&&a<=i}function l(c,a,f,p){var h=0,d=0;if(c==null||(h=s(c,f))!==(d=s(a,f))||u(c,a)<0^f>0)do p.point(h===0||h===3?e:n,h>1?i:t);while((h=(h+f+4)%4)!==d);else p.point(a[0],a[1])}function s(c,a){return B(c[0]-e)<Y?a>0?0:3:B(c[0]-n)<Y?a>0?2:1:B(c[1]-t)<Y?a>0?1:0:a>0?3:2}function o(c,a){return u(c.x,a.x)}function u(c,a){var f=s(c,1),p=s(a,1);return f!==p?f-p:f===0?a[1]-c[1]:f===1?c[0]-a[0]:f===2?c[1]-a[1]:a[0]-c[0]}return function(c){var a=c,f=Hn(),p,h,d,O,b,M,k,_,I,y,D,w={point:P,lineStart:ee,lineEnd:X,polygonStart:j,polygonEnd:T};function P(m,g){r(m,g)&&a.point(m,g)}function L(){for(var m=0,g=0,S=h.length;g<S;++g)for(var z=h[g],C=1,F=z.length,J=z[0],V,G,q=J[0],te=J[1];C<F;++C)V=q,G=te,J=z[C],q=J[0],te=J[1],G<=i?te>i&&(q-V)*(i-G)>(te-G)*(e-V)&&++m:te<=i&&(q-V)*(i-G)<(te-G)*(e-V)&&--m;return m}function j(){a=f,p=[],h=[],D=!0}function T(){var m=L(),g=D&&m,S=(p=Xn(p)).length;(g||S)&&(c.polygonStart(),g&&(c.lineStart(),l(null,null,1,c),c.lineEnd()),S&&Zn(p,o,m,l,c),c.polygonEnd()),a=c,p=h=d=null}function ee(){w.point=v,h&&h.push(d=[]),y=!0,I=!1,k=_=NaN}function X(){p&&(v(O,b),M&&I&&f.rejoin(),p.push(f.result())),w.point=P,I&&a.lineEnd()}function v(m,g){var S=r(m,g);if(h&&d.push([m,g]),y)O=m,b=g,M=S,y=!1,S&&(a.lineStart(),a.point(m,g));else if(S&&I)a.point(m,g);else{var z=[k=Math.max(st,Math.min(Ye,k)),_=Math.max(st,Math.min(Ye,_))],C=[m=Math.max(st,Math.min(Ye,m)),g=Math.max(st,Math.min(Ye,g))];Xi(z,C,e,t,n,i)?(I||(a.lineStart(),a.point(z[0],z[1])),a.point(C[0],C[1]),S||a.lineEnd(),D=!1):S&&(a.lineStart(),a.point(m,g),D=!1)}k=m,_=g,I=S}return w}}const Vt=e=>e;var Dt=new Ce,jt=new Ce,Kn,Qn,At,Ut,we={point:fe,lineStart:fe,lineEnd:fe,polygonStart:function(){we.lineStart=Bi,we.lineEnd=Hi},polygonEnd:function(){we.lineStart=we.lineEnd=we.point=fe,Dt.add(B(jt)),jt=new Ce},result:function(){var e=Dt/2;return Dt=new Ce,e}};function Bi(){we.point=qi}function qi(e,t){we.point=$n,Kn=At=e,Qn=Ut=t}function $n(e,t){jt.add(Ut*e-At*t),At=e,Ut=t}function Hi(){$n(Kn,Qn)}var Ae=1/0,ht=Ae,Ke=-Ae,gt=Ke,vt={point:Zi,lineStart:fe,lineEnd:fe,polygonStart:fe,polygonEnd:fe,result:function(){var e=[[Ae,ht],[Ke,gt]];return Ke=gt=-(ht=Ae=1/0),e}};function Zi(e,t){e<Ae&&(Ae=e),e>Ke&&(Ke=e),t<ht&&(ht=t),t>gt&&(gt=t)}var Yt=0,Xt=0,Xe=0,mt=0,dt=0,Je=0,Gt=0,Bt=0,Ge=0,xn,ei,he,ge,ue={point:Te,lineStart:gn,lineEnd:vn,polygonStart:function(){ue.lineStart=Qi,ue.lineEnd=$i},polygonEnd:function(){ue.point=Te,ue.lineStart=gn,ue.lineEnd=vn},result:function(){var e=Ge?[Gt/Ge,Bt/Ge]:Je?[mt/Je,dt/Je]:Xe?[Yt/Xe,Xt/Xe]:[NaN,NaN];return Yt=Xt=Xe=mt=dt=Je=Gt=Bt=Ge=0,e}};function Te(e,t){Yt+=e,Xt+=t,++Xe}function gn(){ue.point=Wi}function Wi(e,t){ue.point=Ki,Te(he=e,ge=t)}function Ki(e,t){var n=e-he,i=t-ge,r=Fe(n*n+i*i);mt+=r*(he+e)/2,dt+=r*(ge+t)/2,Je+=r,Te(he=e,ge=t)}function vn(){ue.point=Te}function Qi(){ue.point=xi}function $i(){ti(xn,ei)}function xi(e,t){ue.point=ti,Te(xn=he=e,ei=ge=t)}function ti(e,t){var n=e-he,i=t-ge,r=Fe(n*n+i*i);mt+=r*(he+e)/2,dt+=r*(ge+t)/2,Je+=r,r=ge*e-he*t,Gt+=r*(he+e),Bt+=r*(ge+t),Ge+=r*3,Te(he=e,ge=t)}function ni(e){this._context=e}ni.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,ae);break}}},result:fe};var qt=new Ce,Nt,ii,ri,Be,qe,Qe={point:fe,lineStart:function(){Qe.point=er},lineEnd:function(){Nt&&oi(ii,ri),Qe.point=fe},polygonStart:function(){Nt=!0},polygonEnd:function(){Nt=null},result:function(){var e=+qt;return qt=new Ce,e}};function er(e,t){Qe.point=oi,ii=Be=e,ri=qe=t}function oi(e,t){Be-=e,qe-=t,qt.add(Fe(Be*Be+qe*qe)),Be=e,qe=t}let mn,_t,dn,_n;class yn{constructor(t){this._append=t==null?li:tr(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==dn||this._append!==_t){const i=this._radius,r=this._;this._="",this._append`m0,${i}a${i},${i} 0 1,1 0,${-2*i}a${i},${i} 0 1,1 0,${2*i}z`,dn=i,_t=this._append,_n=this._,this._=r}this._+=_n;break}}}result(){const t=this._;return this._="",t.length?t:null}}function li(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function tr(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return li;if(t!==mn){const n=10**t;mn=t,_t=function(r){let l=1;this._+=r[0];for(const s=r.length;l<s;++l)this._+=Math.round(arguments[l]*n)/n+r[l]}}return _t}function $t(e,t){let n=3,i=4.5,r,l;function s(o){return o&&(typeof i=="function"&&l.pointRadius(+i.apply(this,arguments)),Pe(o,r(l))),l.result()}return s.area=function(o){return Pe(o,r(we)),we.result()},s.measure=function(o){return Pe(o,r(Qe)),Qe.result()},s.bounds=function(o){return Pe(o,r(vt)),vt.result()},s.centroid=function(o){return Pe(o,r(ue)),ue.result()},s.projection=function(o){return arguments.length?(r=o==null?(e=null,Vt):(e=o).stream,s):e},s.context=function(o){return arguments.length?(l=o==null?(t=null,new yn(n)):new ni(t=o),typeof i!="function"&&l.pointRadius(i),s):t},s.pointRadius=function(o){return arguments.length?(i=typeof o=="function"?o:(l.pointRadius(+o),+o),s):i},s.digits=function(o){if(!arguments.length)return n;if(o==null)n=null;else{const u=Math.floor(o);if(!(u>=0))throw new RangeError(`invalid digits: ${o}`);n=u}return t===null&&(l=new yn(n)),s},s.projection(e).digits(n).context(t)}function xt(e){return function(t){var n=new Ht;for(var i in e)n[i]=e[i];return n.stream=t,n}}function Ht(){}Ht.prototype={constructor:Ht,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function en(e,t,n){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),i!=null&&e.clipExtent(null),Pe(n,e.stream(vt)),t(vt.result()),i!=null&&e.clipExtent(i),e}function si(e,t,n){return en(e,function(i){var r=t[1][0]-t[0][0],l=t[1][1]-t[0][1],s=Math.min(r/(i[1][0]-i[0][0]),l/(i[1][1]-i[0][1])),o=+t[0][0]+(r-s*(i[1][0]+i[0][0]))/2,u=+t[0][1]+(l-s*(i[1][1]+i[0][1]))/2;e.scale(150*s).translate([o,u])},n)}function nr(e,t,n){return si(e,[[0,0],t],n)}function ir(e,t,n){return en(e,function(i){var r=+t,l=r/(i[1][0]-i[0][0]),s=(r-l*(i[1][0]+i[0][0]))/2,o=-l*i[0][1];e.scale(150*l).translate([s,o])},n)}function rr(e,t,n){return en(e,function(i){var r=+t,l=r/(i[1][1]-i[0][1]),s=-l*i[0][0],o=(r-l*(i[1][1]+i[0][1]))/2;e.scale(150*l).translate([s,o])},n)}var wn=16,or=Z(30*K);function Mn(e,t){return+t?sr(e,t):lr(e)}function lr(e){return xt({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function sr(e,t){function n(i,r,l,s,o,u,c,a,f,p,h,d,O,b){var M=c-i,k=a-r,_=M*M+k*k;if(_>4*t&&O--){var I=s+p,y=o+h,D=u+d,w=Fe(I*I+y*y+D*D),P=We(D/=w),L=B(B(D)-1)<Y||B(l-f)<Y?(l+f)/2:Ze(y,I),j=e(L,P),T=j[0],ee=j[1],X=T-i,v=ee-r,m=k*X-M*v;(m*m/_>t||B((M*X+k*v)/_-.5)>.3||s*p+o*h+u*d<or)&&(n(i,r,l,s,o,u,T,ee,L,I/=w,y/=w,D,O,b),b.point(T,ee),n(T,ee,L,I,y,D,c,a,f,p,h,d,O,b))}}return function(i){var r,l,s,o,u,c,a,f,p,h,d,O,b={point:M,lineStart:k,lineEnd:I,polygonStart:function(){i.polygonStart(),b.lineStart=y},polygonEnd:function(){i.polygonEnd(),b.lineStart=k}};function M(P,L){P=e(P,L),i.point(P[0],P[1])}function k(){f=NaN,b.point=_,i.lineStart()}function _(P,L){var j=je([P,L]),T=e(P,L);n(f,p,a,h,d,O,f=T[0],p=T[1],a=P,h=j[0],d=j[1],O=j[2],wn,i),i.point(f,p)}function I(){b.point=M,i.lineEnd()}function y(){k(),b.point=D,b.lineEnd=w}function D(P,L){_(r=P,L),l=f,s=p,o=h,u=d,c=O,b.point=_}function w(){n(f,p,a,h,d,O,l,s,r,o,u,c,wn,i),b.lineEnd=I,I()}return b}}var ar=xt({point:function(e,t){this.stream.point(e*K,t*K)}});function ur(e){return xt({point:function(t,n){var i=e(t,n);return this.stream.point(i[0],i[1])}})}function fr(e,t,n,i,r){function l(s,o){return s*=i,o*=r,[t+e*s,n-e*o]}return l.invert=function(s,o){return[(s-t)/e*i,(n-o)/e*r]},l}function Sn(e,t,n,i,r,l){if(!l)return fr(e,t,n,i,r);var s=Z(l),o=W(l),u=s*e,c=o*e,a=s/e,f=o/e,p=(o*n-s*t)/e,h=(o*t+s*n)/e;function d(O,b){return O*=i,b*=r,[u*O-c*b+t,n-c*O-u*b]}return d.invert=function(O,b){return[i*(a*O-f*b+p),r*(h-f*O-a*b)]},d}function cr(e){return pr(function(){return e})()}function pr(e){var t,n=150,i=480,r=250,l=0,s=0,o=0,u=0,c=0,a,f=0,p=1,h=1,d=null,O=hn,b=null,M,k,_,I=Vt,y=.5,D,w,P,L,j;function T(m){return P(m[0]*K,m[1]*K)}function ee(m){return m=P.invert(m[0],m[1]),m&&[m[0]*se,m[1]*se]}T.stream=function(m){return L&&j===m?L:L=ar(ur(a)(O(D(I(j=m)))))},T.preclip=function(m){return arguments.length?(O=m,d=void 0,v()):O},T.postclip=function(m){return arguments.length?(I=m,b=M=k=_=null,v()):I},T.clipAngle=function(m){return arguments.length?(O=+m?Yi(d=m*K):(d=null,hn),v()):d*se},T.clipExtent=function(m){return arguments.length?(I=m==null?(b=M=k=_=null,Vt):Gi(b=+m[0][0],M=+m[0][1],k=+m[1][0],_=+m[1][1]),v()):b==null?null:[[b,M],[k,_]]},T.scale=function(m){return arguments.length?(n=+m,X()):n},T.translate=function(m){return arguments.length?(i=+m[0],r=+m[1],X()):[i,r]},T.center=function(m){return arguments.length?(l=m[0]%360*K,s=m[1]%360*K,X()):[l*se,s*se]},T.rotate=function(m){return arguments.length?(o=m[0]%360*K,u=m[1]%360*K,c=m.length>2?m[2]%360*K:0,X()):[o*se,u*se,c*se]},T.angle=function(m){return arguments.length?(f=m%360*K,X()):f*se},T.reflectX=function(m){return arguments.length?(p=m?-1:1,X()):p<0},T.reflectY=function(m){return arguments.length?(h=m?-1:1,X()):h<0},T.precision=function(m){return arguments.length?(D=Mn(w,y=m*m),v()):Fe(y)},T.fitExtent=function(m,g){return si(T,m,g)},T.fitSize=function(m,g){return nr(T,m,g)},T.fitWidth=function(m,g){return ir(T,m,g)},T.fitHeight=function(m,g){return rr(T,m,g)};function X(){var m=Sn(n,0,0,p,h,f).apply(null,t(l,s)),g=Sn(n,i-m[0],r-m[1],p,h,f);return a=qn(o,u,c),w=Lt(t,g),P=Lt(a,w),D=Mn(w,y),v()}function v(){return L=j=null,T}return function(){return t=e.apply(this,arguments),T.invert=t.invert&&ee,X()}}function tn(e,t){return[e,zi(Ti((le+t)/2))]}tn.invert=function(e,t){return[e,2*Bn(Ni(t))-le]};function hr(){return gr(tn).scale(961/ae)}function gr(e){var t=cr(e),n=t.center,i=t.scale,r=t.translate,l=t.clipExtent,s=null,o,u,c;t.scale=function(f){return arguments.length?(i(f),a()):i()},t.translate=function(f){return arguments.length?(r(f),a()):r()},t.center=function(f){return arguments.length?(n(f),a()):n()},t.clipExtent=function(f){return arguments.length?(f==null?s=o=u=c=null:(s=+f[0][0],o=+f[0][1],u=+f[1][0],c=+f[1][1]),a()):s==null?null:[[s,o],[u,c]]};function a(){var f=R*i(),p=t(Pi(t.rotate()).invert([0,0]));return l(s==null?[[p[0]-f,p[1]-f],[p[0]+f,p[1]+f]]:e===tn?[[Math.max(p[0]-f,s),o],[Math.min(p[0]+f,u),c]]:[[s,Math.max(p[1]-f,o)],[u,Math.min(p[1]+f,c)]])}return a()}const at=e=>()=>e;function vr(e,{sourceEvent:t,target:n,transform:i,dispatch:r}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:r}})}function zt(e){e.stopImmediatePropagation()}function Ue(e){e.preventDefault(),e.stopImmediatePropagation()}function mr(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function dr(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function En(){return this.__zoom||Qt}function _r(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function yr(){return navigator.maxTouchPoints||"ontouchstart"in this}function wr(e,t,n){var i=e.invertX(t[0][0])-n[0][0],r=e.invertX(t[1][0])-n[1][0],l=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),s>l?(l+s)/2:Math.min(0,l)||Math.max(0,s))}function Mr(){var e=mr,t=dr,n=wr,i=_r,r=yr,l=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],o=250,u=ki,c=vi("start","zoom","end"),a,f,p,h=500,d=150,O=0,b=10;function M(v){v.property("__zoom",En).on("wheel.zoom",P,{passive:!1}).on("mousedown.zoom",L).on("dblclick.zoom",j).filter(r).on("touchstart.zoom",T).on("touchmove.zoom",ee).on("touchend.zoom touchcancel.zoom",X).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}M.transform=function(v,m,g,S){var z=v.selection?v.selection():v;z.property("__zoom",En),v!==z?y(v,m,g,S):z.interrupt().each(function(){D(this,arguments).event(S).start().zoom(null,typeof m=="function"?m.apply(this,arguments):m).end()})},M.scaleBy=function(v,m,g,S){M.scaleTo(v,function(){var z=this.__zoom.k,C=typeof m=="function"?m.apply(this,arguments):m;return z*C},g,S)},M.scaleTo=function(v,m,g,S){M.transform(v,function(){var z=t.apply(this,arguments),C=this.__zoom,F=g==null?I(z):typeof g=="function"?g.apply(this,arguments):g,J=C.invert(F),V=typeof m=="function"?m.apply(this,arguments):m;return n(_(k(C,V),F,J),z,s)},g,S)},M.translateBy=function(v,m,g,S){M.transform(v,function(){return n(this.__zoom.translate(typeof m=="function"?m.apply(this,arguments):m,typeof g=="function"?g.apply(this,arguments):g),t.apply(this,arguments),s)},null,S)},M.translateTo=function(v,m,g,S,z){M.transform(v,function(){var C=t.apply(this,arguments),F=this.__zoom,J=S==null?I(C):typeof S=="function"?S.apply(this,arguments):S;return n(Qt.translate(J[0],J[1]).scale(F.k).translate(typeof m=="function"?-m.apply(this,arguments):-m,typeof g=="function"?-g.apply(this,arguments):-g),C,s)},S,z)};function k(v,m){return m=Math.max(l[0],Math.min(l[1],m)),m===v.k?v:new Et(m,v.x,v.y)}function _(v,m,g){var S=m[0]-g[0]*v.k,z=m[1]-g[1]*v.k;return S===v.x&&z===v.y?v:new Et(v.k,S,z)}function I(v){return[(+v[0][0]+ +v[1][0])/2,(+v[0][1]+ +v[1][1])/2]}function y(v,m,g,S){v.on("start.zoom",function(){D(this,arguments).event(S).start()}).on("interrupt.zoom end.zoom",function(){D(this,arguments).event(S).end()}).tween("zoom",function(){var z=this,C=arguments,F=D(z,C).event(S),J=t.apply(z,C),V=g==null?I(J):typeof g=="function"?g.apply(z,C):g,G=Math.max(J[1][0]-J[0][0],J[1][1]-J[0][1]),q=z.__zoom,te=typeof m=="function"?m.apply(z,C):m,_e=u(q.invert(V).concat(G/q.k),te.invert(V).concat(G/te.k));return function(ce){if(ce===1)ce=te;else{var ye=_e(ce),Mt=G/ye[2];ce=new Et(Mt,V[0]-ye[0]*Mt,V[1]-ye[1]*Mt)}F.zoom(null,ce)}})}function D(v,m,g){return!g&&v.__zooming||new w(v,m)}function w(v,m){this.that=v,this.args=m,this.active=0,this.sourceEvent=null,this.extent=t.apply(v,m),this.taps=0}w.prototype={event:function(v){return v&&(this.sourceEvent=v),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(v,m){return this.mouse&&v!=="mouse"&&(this.mouse[1]=m.invert(this.mouse[0])),this.touch0&&v!=="touch"&&(this.touch0[1]=m.invert(this.touch0[0])),this.touch1&&v!=="touch"&&(this.touch1[1]=m.invert(this.touch1[0])),this.that.__zoom=m,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(v){var m=oe(this.that).datum();c.call(v,this.that,new vr(v,{sourceEvent:this.sourceEvent,target:M,type:v,transform:this.that.__zoom,dispatch:c}),m)}};function P(v,...m){if(!e.apply(this,arguments))return;var g=D(this,m).event(v),S=this.__zoom,z=Math.max(l[0],Math.min(l[1],S.k*Math.pow(2,i.apply(this,arguments)))),C=De(v);if(g.wheel)(g.mouse[0][0]!==C[0]||g.mouse[0][1]!==C[1])&&(g.mouse[1]=S.invert(g.mouse[0]=C)),clearTimeout(g.wheel);else{if(S.k===z)return;g.mouse=[C,S.invert(C)],bt(this),g.start()}Ue(v),g.wheel=setTimeout(F,d),g.zoom("mouse",n(_(k(S,z),g.mouse[0],g.mouse[1]),g.extent,s));function F(){g.wheel=null,g.end()}}function L(v,...m){if(p||!e.apply(this,arguments))return;var g=v.currentTarget,S=D(this,m,!0).event(v),z=oe(v.view).on("mousemove.zoom",V,!0).on("mouseup.zoom",G,!0),C=De(v,g),F=v.clientX,J=v.clientY;Mi(v.view),zt(v),S.mouse=[C,this.__zoom.invert(C)],bt(this),S.start();function V(q){if(Ue(q),!S.moved){var te=q.clientX-F,_e=q.clientY-J;S.moved=te*te+_e*_e>O}S.event(q).zoom("mouse",n(_(S.that.__zoom,S.mouse[0]=De(q,g),S.mouse[1]),S.extent,s))}function G(q){z.on("mousemove.zoom mouseup.zoom",null),Si(q.view,S.moved),Ue(q),S.event(q).end()}}function j(v,...m){if(e.apply(this,arguments)){var g=this.__zoom,S=De(v.changedTouches?v.changedTouches[0]:v,this),z=g.invert(S),C=g.k*(v.shiftKey?.5:2),F=n(_(k(g,C),S,z),t.apply(this,m),s);Ue(v),o>0?oe(this).transition().duration(o).call(y,F,S,v):oe(this).call(M.transform,F,S,v)}}function T(v,...m){if(e.apply(this,arguments)){var g=v.touches,S=g.length,z=D(this,m,v.changedTouches.length===S).event(v),C,F,J,V;for(zt(v),F=0;F<S;++F)J=g[F],V=De(J,this),V=[V,this.__zoom.invert(V),J.identifier],z.touch0?!z.touch1&&z.touch0[2]!==V[2]&&(z.touch1=V,z.taps=0):(z.touch0=V,C=!0,z.taps=1+!!a);a&&(a=clearTimeout(a)),C&&(z.taps<2&&(f=V[0],a=setTimeout(function(){a=null},h)),bt(this),z.start())}}function ee(v,...m){if(this.__zooming){var g=D(this,m).event(v),S=v.changedTouches,z=S.length,C,F,J,V;for(Ue(v),C=0;C<z;++C)F=S[C],J=De(F,this),g.touch0&&g.touch0[2]===F.identifier?g.touch0[0]=J:g.touch1&&g.touch1[2]===F.identifier&&(g.touch1[0]=J);if(F=g.that.__zoom,g.touch1){var G=g.touch0[0],q=g.touch0[1],te=g.touch1[0],_e=g.touch1[1],ce=(ce=te[0]-G[0])*ce+(ce=te[1]-G[1])*ce,ye=(ye=_e[0]-q[0])*ye+(ye=_e[1]-q[1])*ye;F=k(F,Math.sqrt(ce/ye)),J=[(G[0]+te[0])/2,(G[1]+te[1])/2],V=[(q[0]+_e[0])/2,(q[1]+_e[1])/2]}else if(g.touch0)J=g.touch0[0],V=g.touch0[1];else return;g.zoom("touch",n(_(F,J,V),g.extent,s))}}function X(v,...m){if(this.__zooming){var g=D(this,m).event(v),S=v.changedTouches,z=S.length,C,F;for(zt(v),p&&clearTimeout(p),p=setTimeout(function(){p=null},h),C=0;C<z;++C)F=S[C],g.touch0&&g.touch0[2]===F.identifier?delete g.touch0:g.touch1&&g.touch1[2]===F.identifier&&delete g.touch1;if(g.touch1&&!g.touch0&&(g.touch0=g.touch1,delete g.touch1),g.touch0)g.touch0[1]=this.__zoom.invert(g.touch0[0]);else if(g.end(),g.taps===2&&(F=De(F,this),Math.hypot(f[0]-F[0],f[1]-F[1])<b)){var J=oe(this).on("dblclick.zoom");J&&J.apply(this,arguments)}}}return M.wheelDelta=function(v){return arguments.length?(i=typeof v=="function"?v:at(+v),M):i},M.filter=function(v){return arguments.length?(e=typeof v=="function"?v:at(!!v),M):e},M.touchable=function(v){return arguments.length?(r=typeof v=="function"?v:at(!!v),M):r},M.extent=function(v){return arguments.length?(t=typeof v=="function"?v:at([[+v[0][0],+v[0][1]],[+v[1][0],+v[1][1]]]),M):t},M.scaleExtent=function(v){return arguments.length?(l[0]=+v[0],l[1]=+v[1],M):[l[0],l[1]]},M.translateExtent=function(v){return arguments.length?(s[0][0]=+v[0][0],s[1][0]=+v[1][0],s[0][1]=+v[0][1],s[1][1]=+v[1][1],M):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},M.constrain=function(v){return arguments.length?(n=v,M):n},M.duration=function(v){return arguments.length?(o=+v,M):o},M.interpolate=function(v){return arguments.length?(u=v,M):u},M.on=function(){var v=c.on.apply(c,arguments);return v===c?M:v},M.clickDistance=function(v){return arguments.length?(O=(v=+v)*v,M):Math.sqrt(O)},M.tapDistance=function(v){return arguments.length?(b=+v,M):b},M}function Sr(e){return e}function Er(e){if(e==null)return Sr;var t,n,i=e.scale[0],r=e.scale[1],l=e.translate[0],s=e.translate[1];return function(o,u){u||(t=n=0);var c=2,a=o.length,f=new Array(a);for(f[0]=(t+=o[0])*i+l,f[1]=(n+=o[1])*r+s;c<a;)f[c]=o[c],++c;return f}}function br(e,t){for(var n,i=e.length,r=i-t;r<--i;)n=e[r],e[r++]=e[i],e[i]=n}function Or(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return bn(e,n)})}:bn(e,t)}function bn(e,t){var n=t.id,i=t.bbox,r=t.properties==null?{}:t.properties,l=kr(e,t);return n==null&&i==null?{type:"Feature",properties:r,geometry:l}:i==null?{type:"Feature",id:n,properties:r,geometry:l}:{type:"Feature",id:n,bbox:i,properties:r,geometry:l}}function kr(e,t){var n=Er(e.transform),i=e.arcs;function r(a,f){f.length&&f.pop();for(var p=i[a<0?~a:a],h=0,d=p.length;h<d;++h)f.push(n(p[h],h));a<0&&br(f,d)}function l(a){return n(a)}function s(a){for(var f=[],p=0,h=a.length;p<h;++p)r(a[p],f);return f.length<2&&f.push(f[0]),f}function o(a){for(var f=s(a);f.length<4;)f.push(f[0]);return f}function u(a){return a.map(o)}function c(a){var f=a.type,p;switch(f){case"GeometryCollection":return{type:f,geometries:a.geometries.map(c)};case"Point":p=l(a.coordinates);break;case"MultiPoint":p=a.coordinates.map(l);break;case"LineString":p=s(a.arcs);break;case"MultiLineString":p=a.arcs.map(s);break;case"Polygon":p=u(a.arcs);break;case"MultiPolygon":p=a.arcs.map(u);break;default:return null}return{type:f,coordinates:p}}return c(t)}function On(e,t,n){const i=e.slice();return i[20]=t[n],i}function Ir(e){let t,n,i,r;return{c(){t=ne("circle"),this.h()},l(l){t=ie(l,"circle",{class:!0,cx:!0,cy:!0,r:!0,fill:!0}),U(t).forEach(N),this.h()},h(){E(t,"class",n=`feature-${e[20].properties.id}`),E(t,"cx",i=e[0](e[20])[0]),E(t,"cy",r=e[0](e[20])[1]),E(t,"r","30"),E(t,"fill","#599FF0")},m(l,s){A(l,t,s)},p(l,s){s&256&&n!==(n=`feature-${l[20].properties.id}`)&&E(t,"class",n),s&257&&i!==(i=l[0](l[20])[0])&&E(t,"cx",i),s&257&&r!==(r=l[0](l[20])[1])&&E(t,"cy",r)},d(l){l&&N(t)}}}function Dr(e){let t;function n(l,s){return l[2]?zr:Nr}let i=n(e),r=i(e);return{c(){r.c(),t=x()},l(l){r.l(l),t=x()},m(l,s){r.m(l,s),A(l,t,s)},p(l,s){i===(i=n(l))&&r?r.p(l,s):(r.d(1),r=i(l),r&&(r.c(),r.m(t.parentNode,t)))},d(l){l&&N(t),r.d(l)}}}function Nr(e){let t,n,i;return{c(){t=ne("path"),this.h()},l(r){t=ie(r,"path",{class:!0,d:!0}),U(t).forEach(N),this.h()},h(){E(t,"class",n=ft(`feature-${e[20].properties.id}`)+" svelte-1vx1pyo"),E(t,"d",i=e[9](e[20]))},m(r,l){A(r,t,l)},p(r,l){l&256&&n!==(n=ft(`feature-${r[20].properties.id}`)+" svelte-1vx1pyo")&&E(t,"class",n),l&768&&i!==(i=r[9](r[20]))&&E(t,"d",i)},d(r){r&&N(t)}}}function zr(e){let t=e[20].properties.chapter+"",n,i,r,l,s,o,u;return{c(){n=Oe(t),i=Oe(e[10]),r=ne("path"),this.h()},l(c){n=ke(c,t),i=ke(c,e[10]),r=ie(c,"path",{class:!0,d:!0}),U(r).forEach(N),this.h()},h(){E(r,"class",l=ft(`feature-${e[20].properties.id}`)+" svelte-1vx1pyo"),E(r,"d",s=e[9](e[20])),Q(r,"hover",e[2]&&e[20].properties&&e[20].properties.chapter&&e[10]==e[20].properties.chapter)},m(c,a){A(c,n,a),A(c,i,a),A(c,r,a),o||(u=[Ne(r,"mouseover",function(){Le(e[11](e[20]))&&e[11](e[20]).apply(this,arguments)}),Ne(r,"mouseout",function(){Le(e[12](e[20]))&&e[12](e[20]).apply(this,arguments)}),Ne(r,"click",function(){Le(e[13](e[20]))&&e[13](e[20]).apply(this,arguments)})],o=!0)},p(c,a){e=c,a&256&&t!==(t=e[20].properties.chapter+"")&&Ie(n,t),a&1024&&Ie(i,e[10]),a&256&&l!==(l=ft(`feature-${e[20].properties.id}`)+" svelte-1vx1pyo")&&E(r,"class",l),a&768&&s!==(s=e[9](e[20]))&&E(r,"d",s),a&1284&&Q(r,"hover",e[2]&&e[20].properties&&e[20].properties.chapter&&e[10]==e[20].properties.chapter)},d(c){c&&(N(n),N(i),N(r)),o=!1,Un(u)}}}function kn(e){let t;function n(l,s){return l[4]=="polygons"?Dr:Ir}let i=n(e),r=i(e);return{c(){r.c(),t=x()},l(l){r.l(l),t=x()},m(l,s){r.m(l,s),A(l,t,s)},p(l,s){i===(i=n(l))&&r?r.p(l,s):(r.d(1),r=i(l),r&&(r.c(),r.m(t.parentNode,t)))},d(l){l&&N(t),r.d(l)}}}function Cr(e){let t,n,i,r,l,s,o,u,c=de(e[8]),a=[];for(let f=0;f<c.length;f+=1)a[f]=kn(On(e,c,f));return{c(){t=ne("g"),n=ne("pattern"),i=ne("circle"),r=ne("pattern"),l=ne("circle"),s=ne("pattern"),o=ne("circle");for(let f=0;f<a.length;f+=1)a[f].c();this.h()},l(f){t=ie(f,"g",{class:!0,id:!0});var p=U(t);n=ie(p,"pattern",{id:!0,x:!0,y:!0,width:!0,height:!0,patternUnits:!0});var h=U(n);i=ie(h,"circle",{cx:!0,cy:!0,r:!0,fill:!0}),U(i).forEach(N),h.forEach(N),r=ie(p,"pattern",{id:!0,x:!0,y:!0,width:!0,height:!0,patternUnits:!0});var d=U(r);l=ie(d,"circle",{cx:!0,cy:!0,r:!0,fill:!0}),U(l).forEach(N),d.forEach(N),s=ie(p,"pattern",{id:!0,x:!0,y:!0,width:!0,height:!0,patternUnits:!0});var O=U(s);o=ie(O,"circle",{cx:!0,cy:!0,r:!0,fill:!0}),U(o).forEach(N),O.forEach(N);for(let b=0;b<a.length;b+=1)a[b].l(p);p.forEach(N),this.h()},h(){E(i,"cx","1"),E(i,"cy","1"),E(i,"r","0.6"),E(i,"fill","#A060C1"),E(n,"id","circles-urban-industrial-era"),E(n,"x","0"),E(n,"y","0"),E(n,"width","2"),E(n,"height","2"),E(n,"patternUnits","userSpaceOnUse"),E(l,"cx","5"),E(l,"cy","5"),E(l,"r","2"),E(l,"fill","#83BC6E"),E(r,"id","circles-pre-1600s"),E(r,"x","0"),E(r,"y","0"),E(r,"width","10"),E(r,"height","10"),E(r,"patternUnits","userSpaceOnUse"),E(o,"cx","0.5"),E(o,"cy","0.5"),E(o,"r","0.4"),E(o,"fill","#83BC6E"),E(s,"id","circles-intro"),E(s,"x","0"),E(s,"y","0"),E(s,"width","1"),E(s,"height","1"),E(s,"patternUnits","userSpaceOnUse"),E(t,"class",u=`map-svg-g view-${e[5]} era-${e[6]} stop-${e[7]} svelte-1vx1pyo`),E(t,"id",e[1]),Q(t,"visible",e[3]),Q(t,"hidden",!e[3]),Q(t,"interactive",e[2])},m(f,p){A(f,t,p),H(t,n),H(n,i),H(t,r),H(r,l),H(t,s),H(s,o);for(let h=0;h<a.length;h+=1)a[h]&&a[h].m(t,null)},p(f,[p]){if(p&16149){c=de(f[8]);let h;for(h=0;h<c.length;h+=1){const d=On(f,c,h);a[h]?a[h].p(d,p):(a[h]=kn(d),a[h].c(),a[h].m(t,null))}for(;h<a.length;h+=1)a[h].d(1);a.length=c.length}p&224&&u!==(u=`map-svg-g view-${f[5]} era-${f[6]} stop-${f[7]} svelte-1vx1pyo`)&&E(t,"class",u),p&2&&E(t,"id",f[1]),p&232&&Q(t,"visible",f[3]),p&232&&Q(t,"hidden",!f[3]),p&228&&Q(t,"interactive",f[2])},i:ze,o:ze,d(f){f&&N(t),xe(a,f)}}}function Tr(e,t,n){let{url:i=""}=t,{topoJson:r=!1}=t,{topoJsonObjectsName:l=""}=t,{projection:s}=t,{id:o}=t,{interactive:u=!1}=t,{visible:c=!1}=t,{geometryType:a="polygons"}=t,{activeViewID:f}=t,{activeEraID:p}=t,{activeStopID:h}=t;function d(w){console.log("Map(id: "+o+"):onChapterMouseOver(event:"+JSON.stringify(w.detail)+")"),n(10,k=w.detail.id)}function O(w){console.log("Map(id: "+o+"):onChapterMouseLeave(event:"+JSON.stringify(w.detail)+")"),n(10,k=null)}let b=[],M=null,k=null;const _=yt();wt(()=>{Gn(Kt+i).then(w=>{n(8,b=r?Or(w,w.objects[l]).features:w.features),n(9,M=$t().projection(s))})});function I(w){console.log("Map:onFeatureMouseOver(feature:"+JSON.stringify(w)+")"),w.properties&&w.properties.chapter&&console.log("Map:onFeatureMouseOver(section:"+JSON.stringify(w.properties.chapter)+")"),_("featureMouseOver",{mapID:o,featureID:w.properties&&w.properties.chapter?w.properties.chapter:"?"})}function y(w){console.log("Map:onFeatureMouseOut(feature:"+JSON.stringify(w)+")"),w.properties&&w.properties.chapter&&console.log("Map:onFeatureMouseOut(id:"+JSON.stringify(w.properties.chapter)+")"),_("featureMouseOut",{mapID:o,featureID:w.properties&&w.properties.chapter?w.properties.chapter:"?"})}function D(w){console.log("Map:onFeatureClick(feature:"+JSON.stringify(w)+")"),_("featureClick",{mapID:o,featureID:w.properties&&w.properties.chapter?w.properties.chapter:"?"})}return e.$$set=w=>{"url"in w&&n(14,i=w.url),"topoJson"in w&&n(15,r=w.topoJson),"topoJsonObjectsName"in w&&n(16,l=w.topoJsonObjectsName),"projection"in w&&n(0,s=w.projection),"id"in w&&n(1,o=w.id),"interactive"in w&&n(2,u=w.interactive),"visible"in w&&n(3,c=w.visible),"geometryType"in w&&n(4,a=w.geometryType),"activeViewID"in w&&n(5,f=w.activeViewID),"activeEraID"in w&&n(6,p=w.activeEraID),"activeStopID"in w&&n(7,h=w.activeStopID)},[s,o,u,c,a,f,p,h,b,M,k,I,y,D,i,r,l,d,O]}class ai extends et{constructor(t){super(),tt(this,t,Tr,Cr,$e,{url:14,topoJson:15,topoJsonObjectsName:16,projection:0,id:1,interactive:2,visible:3,geometryType:4,activeViewID:5,activeEraID:6,activeStopID:7,onChapterMouseOver:17,onChapterMouseLeave:18})}get onChapterMouseOver(){return this.$$.ctx[17]}get onChapterMouseLeave(){return this.$$.ctx[18]}}function Fr(e){return e.k}function Pr(e){return[e.x,e.y]}function In(e){return function(){return e}}function Jr(){let e=0,t=0,n=960,i=500,r=!0,l=!0,s=256,o=Fr,u=Pr,c=0;function a(){const f=+o.apply(this,arguments),p=u.apply(this,arguments),h=Math.log2(f/s),d=Math.round(Math.max(h+c,0)),O=Math.pow(2,h-d)*s,b=+p[0]-f/2,M=+p[1]-f/2,k=Math.max(r?0:-1/0,Math.floor((e-b)/O)),_=Math.min(r?1<<d:1/0,Math.ceil((n-b)/O)),I=Math.max(l?0:-1/0,Math.floor((t-M)/O)),y=Math.min(l?1<<d:1/0,Math.ceil((i-M)/O)),D=[];for(let w=I;w<y;++w)for(let P=k;P<_;++P)D.push([P,w,d]);return D.translate=[b/O,M/O],D.scale=O,D}return a.size=function(f){return arguments.length?(e=t=0,n=+f[0],i=+f[1],a):[n-e,i-t]},a.extent=function(f){return arguments.length?(e=+f[0][0],t=+f[0][1],n=+f[1][0],i=+f[1][1],a):[[e,t],[n,i]]},a.scale=function(f){return arguments.length?(o=typeof f=="function"?f:In(+f),a):o},a.translate=function(f){return arguments.length?(u=typeof f=="function"?f:In([+f[0],+f[1]]),a):u},a.zoomDelta=function(f){return arguments.length?(c=+f,a):c},a.tileSize=function(f){return arguments.length?(s=+f,a):s},a.clamp=function(f){return arguments.length?(r=l=!!f,a):r&&l},a.clampX=function(f){return arguments.length?(r=!!f,a):r},a.clampY=function(f){return arguments.length?(l=!!f,a):l},a}function Dn(e,t,n){const i=e.slice();i[11]=t[n];const r=Rr(i[11],i[1]);return i[12]=r[0],i[13]=r[1],i}function Nn(e){let t;return{c(){t=ne("image"),this.h()},l(n){t=ie(n,"image",{"xlink:href":!0,x:!0,y:!0,width:!0,height:!0,class:!0}),U(t).forEach(N),this.h()},h(){ci(t,"xlink:href",e[3](...e[11])),E(t,"x",e[12]),E(t,"y",e[13]),E(t,"width",e[2]),E(t,"height",e[2]),E(t,"class","svelte-511esr")},m(n,i){A(n,t,i)},p:ze,d(n){n&&N(t)}}}function Lr(e){let t,n=de(e[1]),i=[];for(let r=0;r<n.length;r+=1)i[r]=Nn(Dn(e,n,r));return{c(){t=ne("g");for(let r=0;r<i.length;r+=1)i[r].c();this.h()},l(r){t=ie(r,"g",{class:!0});var l=U(t);for(let s=0;s<i.length;s+=1)i[s].l(l);l.forEach(N),this.h()},h(){E(t,"class","map-svg-g svelte-511esr"),Q(t,"visible",e[0])},m(r,l){A(r,t,l);for(let s=0;s<i.length;s+=1)i[s]&&i[s].m(t,null)},p(r,[l]){if(l&14){n=de(r[1]);let s;for(s=0;s<n.length;s+=1){const o=Dn(r,n,s);i[s]?i[s].p(o,l):(i[s]=Nn(o),i[s].c(),i[s].m(t,null))}for(;s<i.length;s+=1)i[s].d(1);i.length=n.length}l&1&&Q(t,"visible",r[0])},i:ze,o:ze,d(r){r&&N(t),xe(i,r)}}}function Rr(e,t){const[n,i]=e,{translate:[r,l],scale:s}=t;return[(n+r)*s,(i+l)*s]}function Vr(e,t,n){let{urlPath:i}=t,{urlExtension:r}=t,{projection:l}=t,{visible:s=!1}=t;yt(),wt(()=>{});const u=Jr().size([2e3,1e3]).scale(l.scale()*2*Math.PI).translate(l([0,0]))(),{translate:[c,a],scale:f}=u,p=(h,d,O)=>`${Kt}${i}${O}/${h}/${d}.${r}`;return e.$$set=h=>{"urlPath"in h&&n(4,i=h.urlPath),"urlExtension"in h&&n(5,r=h.urlExtension),"projection"in h&&n(6,l=h.projection),"visible"in h&&n(0,s=h.visible)},[s,u,f,p,i,r,l]}class jr extends et{constructor(t){super(),tt(this,t,Vr,Lr,$e,{urlPath:4,urlExtension:5,projection:6,visible:0})}}function zn(e,t,n){const i=e.slice();return i[18]=t[n],i}function Cn(e){let t,n=e[18].properties[e[8]]+"",i,r,l;function s(c,a){return c[2]?Ur:Ar}let o=s(e),u=o(e);return{c(){t=ne("text"),i=Oe(n),u.c(),l=x(),this.h()},l(c){t=ie(c,"text",{class:!0,transform:!0,dy:!0});var a=U(t);i=ke(a,n),a.forEach(N),u.l(c),l=x(),this.h()},h(){E(t,"class","text-background svelte-196xzww"),E(t,"transform",r=`translate(${e[0](e[18].geometry.coordinates)})`),E(t,"dy",".35em")},m(c,a){A(c,t,a),H(t,i),u.m(c,a),A(c,l,a)},p(c,a){a&768&&n!==(n=c[18].properties[c[8]]+"")&&Ie(i,n),a&513&&r!==(r=`translate(${c[0](c[18].geometry.coordinates)})`)&&E(t,"transform",r),o===(o=s(c))&&u?u.p(c,a):(u.d(1),u=o(c),u&&(u.c(),u.m(l.parentNode,l)))},d(c){c&&(N(t),N(l)),u.d(c)}}}function Ar(e){let t,n=e[18].properties[e[8]]+"",i,r;return{c(){t=ne("text"),i=Oe(n),this.h()},l(l){t=ie(l,"text",{transform:!0,dy:!0,class:!0});var s=U(t);i=ke(s,n),s.forEach(N),this.h()},h(){E(t,"transform",r=`translate(${e[0](e[18].geometry.coordinates)})`),E(t,"dy",".35em"),E(t,"class","svelte-196xzww")},m(l,s){A(l,t,s),H(t,i)},p(l,s){s&768&&n!==(n=l[18].properties[l[8]]+"")&&Ie(i,n),s&513&&r!==(r=`translate(${l[0](l[18].geometry.coordinates)})`)&&E(t,"transform",r)},d(l){l&&N(t)}}}function Ur(e){let t,n=e[18].properties[e[8]]+"",i,r,l,s;return{c(){t=ne("text"),i=Oe(n),this.h()},l(o){t=ie(o,"text",{transform:!0,dy:!0,class:!0});var u=U(t);i=ke(u,n),u.forEach(N),this.h()},h(){E(t,"transform",r=`translate(${e[0](e[18].geometry.coordinates)})`),E(t,"dy",".35em"),E(t,"class","svelte-196xzww"),Q(t,"hover",e[2]&&e[18].properties&&e[18].properties.chapter&&e[10]==e[18].properties.chapter)},m(o,u){A(o,t,u),H(t,i),l||(s=[Ne(t,"mouseover",function(){Le(e[11](e[18]))&&e[11](e[18]).apply(this,arguments)}),Ne(t,"mouseout",function(){Le(e[12](e[18]))&&e[12](e[18]).apply(this,arguments)}),Ne(t,"click",function(){Le(e[13](e[18]))&&e[13](e[18]).apply(this,arguments)})],l=!0)},p(o,u){e=o,u&768&&n!==(n=e[18].properties[e[8]]+"")&&Ie(i,n),u&513&&r!==(r=`translate(${e[0](e[18].geometry.coordinates)})`)&&E(t,"transform",r),u&1540&&Q(t,"hover",e[2]&&e[18].properties&&e[18].properties.chapter&&e[10]==e[18].properties.chapter)},d(o){o&&N(t),l=!1,Un(s)}}}function Tn(e){let t,n=e[18].geometry&&(!e[4]||e[18].properties.era==e[6])&&Cn(e);return{c(){n&&n.c(),t=x()},l(i){n&&n.l(i),t=x()},m(i,r){n&&n.m(i,r),A(i,t,r)},p(i,r){i[18].geometry&&(!i[4]||i[18].properties.era==i[6])?n?n.p(i,r):(n=Cn(i),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(i){i&&N(t),n&&n.d(i)}}}function Yr(e){let t,n,i=de(e[9]),r=[];for(let l=0;l<i.length;l+=1)r[l]=Tn(zn(e,i,l));return{c(){t=ne("g");for(let l=0;l<r.length;l+=1)r[l].c();this.h()},l(l){t=ie(l,"g",{class:!0,id:!0});var s=U(t);for(let o=0;o<r.length;o+=1)r[o].l(s);s.forEach(N),this.h()},h(){E(t,"class",n=`map-svg-g view-${e[5]} era-${e[6]} stop-${e[7]} svelte-196xzww`),E(t,"id",e[1]),Q(t,"visible",e[3]),Q(t,"hidden",!e[3]),Q(t,"interactive",e[2])},m(l,s){A(l,t,s);for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(t,null)},p(l,[s]){if(s&16213){i=de(l[9]);let o;for(o=0;o<i.length;o+=1){const u=zn(l,i,o);r[o]?r[o].p(u,s):(r[o]=Tn(u),r[o].c(),r[o].m(t,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=i.length}s&224&&n!==(n=`map-svg-g view-${l[5]} era-${l[6]} stop-${l[7]} svelte-196xzww`)&&E(t,"class",n),s&2&&E(t,"id",l[1]),s&232&&Q(t,"visible",l[3]),s&232&&Q(t,"hidden",!l[3]),s&228&&Q(t,"interactive",l[2])},i:ze,o:ze,d(l){l&&N(t),xe(r,l)}}}function Xr(e,t,n){let{path:i}=t,{projection:r}=t,{id:l}=t,{interactive:s=!1}=t,{visible:o=!1}=t,{filterOnContext:u=!1}=t,{activeViewID:c}=t,{activeEraID:a}=t,{activeStopID:f}=t,{labelField:p="label"}=t;function h(y){console.log("Map(id: "+l+"):onChapterMouseOver(event:"+JSON.stringify(y.detail)+")"),n(10,b=y.detail.id)}function d(y){console.log("Map(id: "+l+"):onChapterMouseLeave(event:"+JSON.stringify(y.detail)+")"),n(10,b=null)}let O=[],b=null;const M=yt();wt(()=>{console.log(`Labels:onMount(id:${l})`),Gn(Kt+i).then(y=>{n(9,O=y.features),n(14,i=$t().projection(r))})});function k(y){console.log("Map:onFeatureMouseOver(feature:"+JSON.stringify(y)+")"),y.properties&&y.properties.chapter&&console.log("Map:onFeatureMouseOver(section:"+JSON.stringify(y.properties.chapter)+")"),M("featureMouseOver",{mapID:l,featureID:y.properties&&y.properties.chapter?y.properties.chapter:"?"})}function _(y){console.log("Map:onFeatureMouseOut(feature:"+JSON.stringify(y)+")"),y.properties&&y.properties.chapter&&console.log("Map:onFeatureMouseOut(id:"+JSON.stringify(y.properties.chapter)+")"),M("featureMouseOut",{mapID:l,featureID:y.properties&&y.properties.chapter?y.properties.chapter:"?"})}function I(y){console.log("Map:onFeatureClick(feature:"+JSON.stringify(y)+")"),M("featureClick",{mapID:l,featureID:y.properties&&y.properties.chapter?y.properties.chapter:"?"})}return e.$$set=y=>{"path"in y&&n(14,i=y.path),"projection"in y&&n(0,r=y.projection),"id"in y&&n(1,l=y.id),"interactive"in y&&n(2,s=y.interactive),"visible"in y&&n(3,o=y.visible),"filterOnContext"in y&&n(4,u=y.filterOnContext),"activeViewID"in y&&n(5,c=y.activeViewID),"activeEraID"in y&&n(6,a=y.activeEraID),"activeStopID"in y&&n(7,f=y.activeStopID),"labelField"in y&&n(8,p=y.labelField)},[r,l,s,o,u,c,a,f,p,O,b,k,_,I,i,h,d]}class ui extends et{constructor(t){super(),tt(this,t,Xr,Yr,$e,{path:14,projection:0,id:1,interactive:2,visible:3,filterOnContext:4,activeViewID:5,activeEraID:6,activeStopID:7,labelField:8,onChapterMouseOver:15,onChapterMouseLeave:16})}get onChapterMouseOver(){return this.$$.ctx[15]}get onChapterMouseLeave(){return this.$$.ctx[16]}}function fi(e,t){const n=new IntersectionObserver(i,{threshold:1});n.observe(e);function i(r){const l=r.find(s=>s.isIntersecting);if(l){const s=l.target.dataset.id;t(s)}}return{destroy:()=>n.disconnect()}}function Fn(e,t,n){const i=e.slice();return i[30]=t[n],i[31]=t,i[32]=n,i}function Pn(e,t,n){const i=e.slice();return i[33]=t[n],i}function Jn(e){let t,n,i=e[0].eras[e[5]].shortLabel+"",r,l,s,o=e[0].eras[e[5]].longLabel+"",u;return{c(){t=ve("div"),n=ve("div"),r=Oe(i),l=Re(),s=ve("div"),u=Oe(o),this.h()},l(c){t=me(c,"DIV",{id:!0,class:!0});var a=U(t);n=me(a,"DIV",{id:!0,class:!0});var f=U(n);r=ke(f,i),f.forEach(N),l=Ve(a),s=me(a,"DIV",{id:!0,class:!0});var p=U(s);u=ke(p,o),p.forEach(N),a.forEach(N),this.h()},h(){E(n,"id","era-short-label"),E(n,"class","svelte-7d3ou1"),E(s,"id","era-long-label"),E(s,"class","svelte-7d3ou1"),E(t,"id","story-context-container"),E(t,"class","svelte-7d3ou1")},m(c,a){A(c,t,a),H(t,n),H(n,r),H(t,l),H(t,s),H(s,u)},p(c,a){a[0]&33&&i!==(i=c[0].eras[c[5]].shortLabel+"")&&Ie(r,i),a[0]&33&&o!==(o=c[0].eras[c[5]].longLabel+"")&&Ie(u,o)},d(c){c&&N(t)}}}function Ln(e){let t,n,i,r=e[0].views[e[4]].name+"",l,s,o,u,c=de(e[0].views[e[4]].story),a=[];for(let f=0;f<c.length;f+=1)a[f]=Rn(Pn(e,c,f));return{c(){t=ve("div"),n=ve("div"),i=ve("h1"),l=Oe(r),s=Re();for(let f=0;f<a.length;f+=1)a[f].c();this.h()},l(f){t=me(f,"DIV",{id:!0,class:!0});var p=U(t);n=me(p,"DIV",{id:!0,class:!0});var h=U(n);i=me(h,"H1",{class:!0});var d=U(i);l=ke(d,r),d.forEach(N),s=Ve(h);for(let O=0;O<a.length;O+=1)a[O].l(h);h.forEach(N),p.forEach(N),this.h()},h(){E(i,"class","svelte-7d3ou1"),E(n,"id","story-narrative"),E(n,"class","svelte-7d3ou1"),E(t,"id","story-narrative-container"),E(t,"class","svelte-7d3ou1")},m(f,p){A(f,t,p),H(t,n),H(n,i),H(i,l),H(n,s);for(let h=0;h<a.length;h+=1)a[h]&&a[h].m(n,null);o||(u=Yn(fi.call(null,i,e[12])),o=!0)},p(f,p){if(p[0]&17&&r!==(r=f[0].views[f[4]].name+"")&&Ie(l,r),p[0]&4113){c=de(f[0].views[f[4]].story);let h;for(h=0;h<c.length;h+=1){const d=Pn(f,c,h);a[h]?a[h].p(d,p):(a[h]=Rn(d),a[h].c(),a[h].m(n,null))}for(;h<a.length;h+=1)a[h].d(1);a.length=c.length}},d(f){f&&N(t),xe(a,f),o=!1,u()}}}function Gr(e){let t,n,i=e[33].text+"";return{c(){t=ve("p"),n=new Zt(!1),this.h()},l(r){t=me(r,"P",{});var l=U(t);n=Wt(l,!1),l.forEach(N),this.h()},h(){n.a=null},m(r,l){A(r,t,l),n.m(i,t)},p(r,l){l[0]&17&&i!==(i=r[33].text+"")&&n.p(i)},d(r){r&&N(t)}}}function Br(e){let t;function n(l,s){return l[33].stop?Hr:qr}let i=n(e),r=i(e);return{c(){r.c(),t=x()},l(l){r.l(l),t=x()},m(l,s){r.m(l,s),A(l,t,s)},p(l,s){i===(i=n(l))&&r?r.p(l,s):(r.d(1),r=i(l),r&&(r.c(),r.m(t.parentNode,t)))},d(l){l&&N(t),r.d(l)}}}function qr(e){let t,n,i=e[33].text+"";return{c(){t=ve("h2"),n=new Zt(!1),this.h()},l(r){t=me(r,"H2",{class:!0});var l=U(t);n=Wt(l,!1),l.forEach(N),this.h()},h(){n.a=null,E(t,"class","svelte-7d3ou1")},m(r,l){A(r,t,l),n.m(i,t)},p(r,l){l[0]&17&&i!==(i=r[33].text+"")&&n.p(i)},d(r){r&&N(t)}}}function Hr(e){let t,n,i=e[33].text+"",r,l,s;return{c(){t=ve("h2"),n=new Zt(!1),this.h()},l(o){t=me(o,"H2",{"data-id":!0,class:!0});var u=U(t);n=Wt(u,!1),u.forEach(N),this.h()},h(){n.a=null,E(t,"data-id",r=e[33].stop),E(t,"class","svelte-7d3ou1")},m(o,u){A(o,t,u),n.m(i,t),l||(s=Yn(fi.call(null,t,e[12])),l=!0)},p(o,u){u[0]&17&&i!==(i=o[33].text+"")&&n.p(i),u[0]&17&&r!==(r=o[33].stop)&&E(t,"data-id",r)},d(o){o&&N(t),l=!1,s()}}}function Rn(e){let t;function n(l,s){if(l[33].type=="h")return Br;if(l[33].type=="p")return Gr}let i=n(e),r=i&&i(e);return{c(){r&&r.c(),t=x()},l(l){r&&r.l(l),t=x()},m(l,s){r&&r.m(l,s),A(l,t,s)},p(l,s){i===(i=n(l))&&r?r.p(l,s):(r&&r.d(1),r=i&&i(l),r&&(r.c(),r.m(t.parentNode,t)))},d(l){l&&N(t),r&&r.d(l)}}}function Vn(e){let t,n,i=de(Object.values(e[0].maps)),r=[];for(let s=0;s<i.length;s+=1)r[s]=jn(Fn(e,i,s));const l=s=>re(r[s],1,1,()=>{r[s]=null});return{c(){for(let s=0;s<r.length;s+=1)r[s].c();t=x()},l(s){for(let o=0;o<r.length;o+=1)r[o].l(s);t=x()},m(s,o){for(let u=0;u<r.length;u+=1)r[u]&&r[u].m(s,o);A(s,t,o),n=!0},p(s,o){if(o[0]&3827){i=de(Object.values(s[0].maps));let u;for(u=0;u<i.length;u+=1){const c=Fn(s,i,u);r[u]?(r[u].p(c,o),$(r[u],1)):(r[u]=jn(c),r[u].c(),$(r[u],1),r[u].m(t.parentNode,t))}for(nt(),u=i.length;u<r.length;u+=1)l(u);it()}},i(s){if(!n){for(let o=0;o<i.length;o+=1)$(r[o]);n=!0}},o(s){r=r.filter(Boolean);for(let o=0;o<r.length;o+=1)re(r[o]);n=!1},d(s){s&&N(t),xe(r,s)}}}function Zr(e){let t,n,i,r;const l=[$r,Qr],s=[];function o(u,c){return u[30].interactive?0:1}return t=o(e),n=s[t]=l[t](e),{c(){n.c(),i=x()},l(u){n.l(u),i=x()},m(u,c){s[t].m(u,c),A(u,i,c),r=!0},p(u,c){let a=t;t=o(u),t===a?s[t].p(u,c):(nt(),re(s[a],1,1,()=>{s[a]=null}),it(),n=s[t],n?n.p(u,c):(n=s[t]=l[t](u),n.c()),$(n,1),n.m(i.parentNode,i))},i(u){r||($(n),r=!0)},o(u){re(n),r=!1},d(u){u&&N(i),s[t].d(u)}}}function Wr(e){let t,n=e[32],i;const r=()=>e[18](t,n),l=()=>e[18](null,n);let s={urlPath:e[30].urlPath,urlExtension:e[30].urlExtension,projection:e[7],visible:e[6]==null&&e[0].views[e[4]].maps&&e[0].views[e[4]].maps.includes(e[30].id)||e[6]&&e[0].views[e[4]].stops[e[6]].maps&&e[0].views[e[4]].stops[e[6]].maps.includes(e[30].id)};return t=new jr({props:s}),r(),{c(){Me(t.$$.fragment)},l(o){Se(t.$$.fragment,o)},m(o,u){Ee(t,o,u),i=!0},p(o,u){n!==o[32]&&(l(),n=o[32],r());const c={};u[0]&1&&(c.urlPath=o[30].urlPath),u[0]&1&&(c.urlExtension=o[30].urlExtension),u[0]&128&&(c.projection=o[7]),u[0]&81&&(c.visible=o[6]==null&&o[0].views[o[4]].maps&&o[0].views[o[4]].maps.includes(o[30].id)||o[6]&&o[0].views[o[4]].stops[o[6]].maps&&o[0].views[o[4]].stops[o[6]].maps.includes(o[30].id)),t.$set(c)},i(o){i||($(t.$$.fragment,o),i=!0)},o(o){re(t.$$.fragment,o),i=!1},d(o){l(),be(t,o)}}}function Kr(e){let t,n,i,r;const l=[eo,xr],s=[];function o(u,c){return u[30].interactive?0:1}return t=o(e),n=s[t]=l[t](e),{c(){n.c(),i=x()},l(u){n.l(u),i=x()},m(u,c){s[t].m(u,c),A(u,i,c),r=!0},p(u,c){let a=t;t=o(u),t===a?s[t].p(u,c):(nt(),re(s[a],1,1,()=>{s[a]=null}),it(),n=s[t],n?n.p(u,c):(n=s[t]=l[t](u),n.c()),$(n,1),n.m(i.parentNode,i))},i(u){r||($(n),r=!0)},o(u){re(n),r=!1},d(u){u&&N(i),s[t].d(u)}}}function Qr(e){let t,n=e[32],i;const r=()=>e[20](t,n),l=()=>e[20](null,n);let s={activeViewID:e[4],activeEraID:e[5],activeStopID:e[6],path:e[30].path,id:e[30].id,projection:e[7],visible:e[6]==null&&e[0].views[e[4]].maps&&e[0].views[e[4]].maps.includes(e[30].id)||e[6]&&e[0].views[e[4]].stops[e[6]].maps&&e[0].views[e[4]].stops[e[6]].maps.includes(e[30].id),labelField:e[30].labelField,filterOnContext:e[30].filterOnContext,interactive:e[30].interactive};return t=new ui({props:s}),r(),{c(){Me(t.$$.fragment)},l(o){Se(t.$$.fragment,o)},m(o,u){Ee(t,o,u),i=!0},p(o,u){n!==o[32]&&(l(),n=o[32],r());const c={};u[0]&16&&(c.activeViewID=o[4]),u[0]&32&&(c.activeEraID=o[5]),u[0]&64&&(c.activeStopID=o[6]),u[0]&1&&(c.path=o[30].path),u[0]&1&&(c.id=o[30].id),u[0]&128&&(c.projection=o[7]),u[0]&81&&(c.visible=o[6]==null&&o[0].views[o[4]].maps&&o[0].views[o[4]].maps.includes(o[30].id)||o[6]&&o[0].views[o[4]].stops[o[6]].maps&&o[0].views[o[4]].stops[o[6]].maps.includes(o[30].id)),u[0]&1&&(c.labelField=o[30].labelField),u[0]&1&&(c.filterOnContext=o[30].filterOnContext),u[0]&1&&(c.interactive=o[30].interactive),t.$set(c)},i(o){i||($(t.$$.fragment,o),i=!0)},o(o){re(t.$$.fragment,o),i=!1},d(o){l(),be(t,o)}}}function $r(e){let t,n=e[32],i;const r=()=>e[19](t,n),l=()=>e[19](null,n);let s={activeViewID:e[4],activeEraID:e[5],activeStopID:e[6],path:e[30].path,id:e[30].id,projection:e[7],visible:e[6]==null&&e[0].views[e[4]].maps&&e[0].views[e[4]].maps.includes(e[30].id)||e[6]&&e[0].views[e[4]].stops[e[6]].maps&&e[0].views[e[4]].stops[e[6]].maps.includes(e[30].id),labelField:e[30].labelField,filterOnContext:e[30].filterOnContext,interactive:e[30].interactive};return t=new ui({props:s}),r(),t.$on("featureMouseOver",e[9]),t.$on("featureMouseOut",e[10]),t.$on("featureClick",e[11]),{c(){Me(t.$$.fragment)},l(o){Se(t.$$.fragment,o)},m(o,u){Ee(t,o,u),i=!0},p(o,u){n!==o[32]&&(l(),n=o[32],r());const c={};u[0]&16&&(c.activeViewID=o[4]),u[0]&32&&(c.activeEraID=o[5]),u[0]&64&&(c.activeStopID=o[6]),u[0]&1&&(c.path=o[30].path),u[0]&1&&(c.id=o[30].id),u[0]&128&&(c.projection=o[7]),u[0]&81&&(c.visible=o[6]==null&&o[0].views[o[4]].maps&&o[0].views[o[4]].maps.includes(o[30].id)||o[6]&&o[0].views[o[4]].stops[o[6]].maps&&o[0].views[o[4]].stops[o[6]].maps.includes(o[30].id)),u[0]&1&&(c.labelField=o[30].labelField),u[0]&1&&(c.filterOnContext=o[30].filterOnContext),u[0]&1&&(c.interactive=o[30].interactive),t.$set(c)},i(o){i||($(t.$$.fragment,o),i=!0)},o(o){re(t.$$.fragment,o),i=!1},d(o){l(),be(t,o)}}}function xr(e){let t,n=e[32],i;const r=()=>e[17](t,n),l=()=>e[17](null,n);let s={activeViewID:e[4],activeEraID:e[5],activeStopID:e[6],url:e[30].url,topoJson:e[30].topoJson,topoJsonObjectsName:e[30].topoJsonObjectsName,geometryType:e[30].geometryType?e[30].geometryType:"polygons",id:e[30].id,projection:e[7],visible:e[6]==null&&e[0].views[e[4]].maps&&e[0].views[e[4]].maps.includes(e[30].id)||e[6]&&e[0].views[e[4]].stops[e[6]].maps&&e[0].views[e[4]].stops[e[6]].maps.includes(e[30].id)};return t=new ai({props:s}),r(),{c(){Me(t.$$.fragment)},l(o){Se(t.$$.fragment,o)},m(o,u){Ee(t,o,u),i=!0},p(o,u){n!==o[32]&&(l(),n=o[32],r());const c={};u[0]&16&&(c.activeViewID=o[4]),u[0]&32&&(c.activeEraID=o[5]),u[0]&64&&(c.activeStopID=o[6]),u[0]&1&&(c.url=o[30].url),u[0]&1&&(c.topoJson=o[30].topoJson),u[0]&1&&(c.topoJsonObjectsName=o[30].topoJsonObjectsName),u[0]&1&&(c.geometryType=o[30].geometryType?o[30].geometryType:"polygons"),u[0]&1&&(c.id=o[30].id),u[0]&128&&(c.projection=o[7]),u[0]&81&&(c.visible=o[6]==null&&o[0].views[o[4]].maps&&o[0].views[o[4]].maps.includes(o[30].id)||o[6]&&o[0].views[o[4]].stops[o[6]].maps&&o[0].views[o[4]].stops[o[6]].maps.includes(o[30].id)),t.$set(c)},i(o){i||($(t.$$.fragment,o),i=!0)},o(o){re(t.$$.fragment,o),i=!1},d(o){l(),be(t,o)}}}function eo(e){let t,n=e[32],i;const r=()=>e[16](t,n),l=()=>e[16](null,n);let s={activeViewID:e[4],activeEraID:e[5],activeStopID:e[6],url:e[30].url,topoJson:e[30].topoJson,topoJsonObjectsName:e[30].topoJsonObjectsName,geometryType:e[30].geometryType?e[30].geometryType:"polygons",id:e[30].id,projection:e[7],visible:e[6]==null&&e[0].views[e[4]].maps&&e[0].views[e[4]].maps.includes(e[30].id)||e[6]&&e[0].views[e[4]].stops[e[6]].maps&&e[0].views[e[4]].stops[e[6]].maps.includes(e[30].id),interactive:!0};return t=new ai({props:s}),r(),t.$on("featureMouseOver",e[9]),t.$on("featureMouseOut",e[10]),t.$on("featureClick",e[11]),{c(){Me(t.$$.fragment)},l(o){Se(t.$$.fragment,o)},m(o,u){Ee(t,o,u),i=!0},p(o,u){n!==o[32]&&(l(),n=o[32],r());const c={};u[0]&16&&(c.activeViewID=o[4]),u[0]&32&&(c.activeEraID=o[5]),u[0]&64&&(c.activeStopID=o[6]),u[0]&1&&(c.url=o[30].url),u[0]&1&&(c.topoJson=o[30].topoJson),u[0]&1&&(c.topoJsonObjectsName=o[30].topoJsonObjectsName),u[0]&1&&(c.geometryType=o[30].geometryType?o[30].geometryType:"polygons"),u[0]&1&&(c.id=o[30].id),u[0]&128&&(c.projection=o[7]),u[0]&81&&(c.visible=o[6]==null&&o[0].views[o[4]].maps&&o[0].views[o[4]].maps.includes(o[30].id)||o[6]&&o[0].views[o[4]].stops[o[6]].maps&&o[0].views[o[4]].stops[o[6]].maps.includes(o[30].id)),t.$set(c)},i(o){i||($(t.$$.fragment,o),i=!0)},o(o){re(t.$$.fragment,o),i=!1},d(o){l(),be(t,o)}}}function jn(e){let t,n,i,r;const l=[Kr,Wr,Zr],s=[];function o(u,c){return u[30].type=="shapefile"?0:u[30].type=="tile"?1:u[30].type=="label"?2:-1}return~(t=o(e))&&(n=s[t]=l[t](e)),{c(){n&&n.c(),i=x()},l(u){n&&n.l(u),i=x()},m(u,c){~t&&s[t].m(u,c),A(u,i,c),r=!0},p(u,c){let a=t;t=o(u),t===a?~t&&s[t].p(u,c):(n&&(nt(),re(s[a],1,1,()=>{s[a]=null}),it()),~t?(n=s[t],n?n.p(u,c):(n=s[t]=l[t](u),n.c()),$(n,1),n.m(i.parentNode,i)):n=null)},i(u){r||($(n),r=!0)},o(u){re(n),r=!1},d(u){u&&N(i),~t&&s[t].d(u)}}}function to(e){let t,n,i,r,l,s,o,u=e[5]&&Jn(e),c=e[0].views[e[4]].story&&Ln(e),a=!e[8]&&Vn(e);return{c(){t=ve("div"),u&&u.c(),n=Re(),c&&c.c(),i=Re(),r=ne("svg"),l=ne("g"),a&&a.c(),this.h()},l(f){t=me(f,"DIV",{id:!0,class:!0,style:!0});var p=U(t);u&&u.l(p),n=Ve(p),c&&c.l(p),i=Ve(p),r=ie(p,"svg",{id:!0,class:!0});var h=U(r);l=ie(h,"g",{});var d=U(l);a&&a.l(d),d.forEach(N),h.forEach(N),p.forEach(N),this.h()},h(){E(r,"id","map-svg"),E(r,"class","svelte-7d3ou1"),Q(r,"story",e[0].views[e[4]].story!=null),E(t,"id","map"),E(t,"class",s=`view-${e[4]} era-${e[5]} stop-${e[6]} svelte-7d3ou1`),St(t,"--color-era-urban-industrial",Ot.colorEraUrbanIndustrial),St(t,"--color-era-pre-1600s",Ot.colorEraPre1600s),St(t,"--color-era-early-european-settlement",Ot.colorEraEarlyEuropeanSettlement)},m(f,p){A(f,t,p),u&&u.m(t,null),H(t,n),c&&c.m(t,null),H(t,i),H(t,r),H(r,l),a&&a.m(l,null),e[21](l),e[22](r),o=!0},p(f,p){f[5]?u?u.p(f,p):(u=Jn(f),u.c(),u.m(t,n)):u&&(u.d(1),u=null),f[0].views[f[4]].story?c?c.p(f,p):(c=Ln(f),c.c(),c.m(t,i)):c&&(c.d(1),c=null),f[8]?a&&(nt(),re(a,1,1,()=>{a=null}),it()):a?(a.p(f,p),p[0]&256&&$(a,1)):(a=Vn(f),a.c(),$(a,1),a.m(l,null)),(!o||p[0]&17)&&Q(r,"story",f[0].views[f[4]].story!=null),(!o||p[0]&112&&s!==(s=`view-${f[4]} era-${f[5]} stop-${f[6]} svelte-7d3ou1`))&&E(t,"class",s)},i(f){o||($(a),o=!0)},o(f){re(a),o=!1},d(f){f&&N(t),u&&u.d(),c&&c.d(),a&&a.d(),e[21](null),e[22](null)}}}const no=4e3;function An(e){return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{coordinates:[[[e.nwLng,e.nwLat],[e.seLng,e.nwLat],[e.seLng,e.seLat],[e.nwLng,e.seLat],[e.nwLng,e.nwLat]]],type:"Polygon"}}]}}function io(e,t,n){let{story:i={}}=t;function r(g){console.log("Maps:onChapterMouseOver(event:"+JSON.stringify(g.detail)+")"),o.forEach(S=>{S.onChapterMouseOver&&S.onChapterMouseOver(g)})}function l(g){console.log("Maps:onChapterMouseLeave(event:"+JSON.stringify(g.detail)+")"),o.forEach(S=>{S.onChapterMouseLeave&&S.onChapterMouseLeave(g)})}function s(g){console.log(`Maps:onNavigate(event:${JSON.stringify(g.detail)})`),n(4,h=g.detail.viewID),n(5,d=g.detail.eraID),n(6,O=null),i.views[h].extent&&_(i.views[h].extent)}let o=[],u,c,a,f,p,h=i.intialView,d=null,O=null,b,M=!0;wt(()=>{console.log("Maps:onMount()"),a=parseInt(oe(u).style("width"),10),f=parseInt(oe(u).style("height"),10),console.log(`Map width: ${a}; height: ${f}`),n(7,b=hr().rotate([74,0]).fitSize([a,f],An(i.views[i.intialView].extent))),n(8,M=!1)}),p=Mr().on("zoom",I);const k=yt();function _(g){console.log(`Maps:moveMap(extent:${JSON.stringify(g)}`),a=parseInt(oe("#map-svg").style("width"),10),f=parseInt(oe("#map-svg").style("height"),10),console.log(`Map width: ${a}; height: ${f}`);const S=An(g);var z=$t().projection(b);const C=z.bounds(S),[[F,J],[V,G]]=C;oe(c).transition().duration(no).ease(mi).call(p.transform,Qt.translate(a/2,f/2).scale(.9/Math.max((V-F)/a,(G-J)/f)).translate(-(F+V)/2,-(J+G)/2))}function I(g){const{transform:S}=g;oe(c).attr("transform",S),oe(c).selectAll("text").attr("font-size",10/S.k)}function y(g){console.log("Maps:onFeatureMouseOver(event.detail:"+JSON.stringify(g.detail)+")"),k("featureMouseOver",g.detail)}function D(g){console.log("Maps:onFeatureMouseOut(event.detail:"+JSON.stringify(g.detail)+")"),k("featureMouseOut",g.detail)}function w(g){console.log("Maps:onFeatureClick(event.detail:"+JSON.stringify(g.detail)+")"),k("featureClick",g.detail)}function P(g){console.log(`Maps:onStop(stopID:${g})`),n(6,O=g),g?i.views[h].stops&&i.views[h].stops[O]&&_(i.views[h].stops[O].extent):_(i.views[h].extent)}function L(g,S){pe[g?"unshift":"push"](()=>{o[S]=g,n(1,o)})}function j(g,S){pe[g?"unshift":"push"](()=>{o[S]=g,n(1,o)})}function T(g,S){pe[g?"unshift":"push"](()=>{o[S]=g,n(1,o)})}function ee(g,S){pe[g?"unshift":"push"](()=>{o[S]=g,n(1,o)})}function X(g,S){pe[g?"unshift":"push"](()=>{o[S]=g,n(1,o)})}function v(g){pe[g?"unshift":"push"](()=>{c=g,n(3,c)})}function m(g){pe[g?"unshift":"push"](()=>{u=g,n(2,u)})}return e.$$set=g=>{"story"in g&&n(0,i=g.story)},[i,o,u,c,h,d,O,b,M,y,D,w,P,r,l,s,L,j,T,ee,X,v,m]}class ro extends et{constructor(t){super(),tt(this,t,io,to,$e,{story:0,onChapterMouseOver:13,onChapterMouseLeave:14,onNavigate:15},null,[-1,-1])}get onChapterMouseOver(){return this.$$.ctx[13]}get onChapterMouseLeave(){return this.$$.ctx[14]}get onNavigate(){return this.$$.ctx[15]}}function oo(e){let t,n,i,r,l,s,o,u,c={};t=new di({props:c}),e[10](t),t.$on("navigate",e[8]);let a={story:He};i=new ro({props:a}),e[11](i),i.$on("featureMouseOver",e[3]),i.$on("featureMouseOut",e[4]),i.$on("featureClick",e[7]);let f={eras:He.eras};return l=new _i({props:f}),e[12](l),l.$on("chapterMouseOver",e[5]),l.$on("chapterMouseLeave",e[6]),l.$on("navigate",e[8]),{c(){Me(t.$$.fragment),n=Re(),Me(i.$$.fragment),r=Re(),Me(l.$$.fragment)},l(p){Se(t.$$.fragment,p),n=Ve(p),Se(i.$$.fragment,p),r=Ve(p),Se(l.$$.fragment,p)},m(p,h){Ee(t,p,h),A(p,n,h),Ee(i,p,h),A(p,r,h),Ee(l,p,h),s=!0,o||(u=Ne(window,"popstate",e[9]),o=!0)},p(p,[h]){const d={};t.$set(d);const O={};i.$set(O);const b={};l.$set(b)},i(p){s||($(t.$$.fragment,p),$(i.$$.fragment,p),$(l.$$.fragment,p),s=!0)},o(p){re(t.$$.fragment,p),re(i.$$.fragment,p),re(l.$$.fragment,p),s=!1},d(p){p&&(N(n),N(r)),e[10](null),be(t,p),e[11](null),be(i,p),e[12](null),be(l,p),o=!1,u()}}}function lo(e,t,n){let i;pi(e,gi,_=>n(17,i=_));let r,l,s,o="intro";He.views[o];let u=null;function c(_){console.log("routes/map:onFeatureMouseOver(event.detail:"+JSON.stringify(_.detail)+")"),l.onMapFeatureMouseOver(_)}function a(_){console.log("routes/map:onMapFeatureMouseOut(event.detail:"+JSON.stringify(_.detail)+")"),l.onMapFeatureMouseOut(_)}function f(_){console.log("routes/map:onChapterMouseOver(event.detail:"+JSON.stringify(_.detail)+")"),s.onChapterMouseOver(_)}function p(_){console.log("routes/map:onChapterMouseLeave(event.detail:"+JSON.stringify(_.detail)+")"),s.onChapterMouseLeave(_)}function h(_){console.log("routes/map:onFeatureClick(event.detail:"+JSON.stringify(_.detail)+")"),l.onMapFeatureClick(_)}function d(_,I=!0){console.log(`routes/map:onNavigate(event.detail:${JSON.stringify(_.detail)})`),o=_.detail.viewID,He.views[o],u=_.detail.eraID,u&&He.eras[u],r.navigate(_),s.onNavigate(_),l.onNavigate(_),I&&hi(`#/view/${_.detail.viewID}`,{state:_.detail})}function O(_){_.state&&(console.log(`routes/:popstate:event.state:${JSON.stringify(_.state)}`),console.log(`routes/:popstate:page.state:${JSON.stringify(i.state)}`),_.state["sveltekit:states"].viewID&&d({detail:{..._.state["sveltekit:states"]}},!1))}function b(_){pe[_?"unshift":"push"](()=>{r=_,n(0,r)})}function M(_){pe[_?"unshift":"push"](()=>{s=_,n(2,s)})}function k(_){pe[_?"unshift":"push"](()=>{l=_,n(1,l)})}return[r,l,s,c,a,f,p,h,d,O,b,M,k]}class po extends et{constructor(t){super(),tt(this,t,lo,oo,$e,{})}}export{po as component};
