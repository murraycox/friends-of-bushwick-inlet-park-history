import{s as ve,e as N,a as T,w as ie,c as E,b as I,g as V,x as le,f as g,q as c,y as oe,v as G,i as M,h as y,z as je,A as Te,t as W,d as Z,j as K,B as de,C as ge,D as O,E as D,H as Q,p as X,F as Ve,k as Pe}from"../chunks/scheduler.B6tvtqyu.js";import{S as he,i as be,t as h,g as P,a as w,e as z,c as C,b as J,m as S,d as L}from"../chunks/index.Dc0GTl0m.js";import{g as ze}from"../chunks/entry.BkjszZmw.js";import{p as He}from"../chunks/stores.B5w-Aowz.js";import{s as U,b as j,e as q,c as Re,i as Ae,N as qe,a as Be}from"../chunks/styles.CynTB6G1.js";import{g as Ge,z as Ue,a as We,T as Ze,L as ce,M as we}from"../chunks/Labels.C2HATShD.js";import{o as ke}from"../chunks/on-scroll.C82PX1iQ.js";import{s as R}from"../chunks/story.8cFPNhpA.js";function ne(s,i,n){const a=s.slice();return a[30]=i[n],a[31]=i,a[32]=n,a}function ae(s,i,n){const a=s.slice();return a[33]=i[n],a}function te(s){let i,n,a=s[0].eras[s[5]].shortLabel+"",o,t,u,e=s[0].eras[s[5]].longLabel+"",l;return{c(){i=N("div"),n=N("div"),o=W(a),t=T(),u=N("div"),l=W(e),this.h()},l(r){i=E(r,"DIV",{id:!0,class:!0});var f=I(i);n=E(f,"DIV",{id:!0,class:!0});var p=I(n);o=Z(p,a),p.forEach(g),t=V(f),u=E(f,"DIV",{id:!0,class:!0});var m=I(u);l=Z(m,e),m.forEach(g),f.forEach(g),this.h()},h(){c(n,"id","era-short-label"),c(n,"class","svelte-7d3ou1"),c(u,"id","era-long-label"),c(u,"class","svelte-7d3ou1"),c(i,"id","story-context-container"),c(i,"class","svelte-7d3ou1")},m(r,f){M(r,i,f),y(i,n),y(n,o),y(i,t),y(i,u),y(u,l)},p(r,f){f[0]&33&&a!==(a=r[0].eras[r[5]].shortLabel+"")&&K(o,a),f[0]&33&&e!==(e=r[0].eras[r[5]].longLabel+"")&&K(l,e)},d(r){r&&g(i)}}}function re(s){let i,n,a,o=s[0].views[s[4]].name+"",t,u,e,l,r=q(s[0].views[s[4]].story),f=[];for(let p=0;p<r.length;p+=1)f[p]=ue(ae(s,r,p));return{c(){i=N("div"),n=N("div"),a=N("h1"),t=W(o),u=T();for(let p=0;p<f.length;p+=1)f[p].c();this.h()},l(p){i=E(p,"DIV",{id:!0,class:!0});var m=I(i);n=E(m,"DIV",{id:!0,class:!0});var v=I(n);a=E(v,"H1",{class:!0});var k=I(a);t=Z(k,o),k.forEach(g),u=V(v);for(let $=0;$<f.length;$+=1)f[$].l(v);v.forEach(g),m.forEach(g),this.h()},h(){c(a,"class","svelte-7d3ou1"),c(n,"id","story-narrative"),c(n,"class","svelte-7d3ou1"),c(i,"id","story-narrative-container"),c(i,"class","svelte-7d3ou1")},m(p,m){M(p,i,m),y(i,n),y(n,a),y(a,t),y(n,u);for(let v=0;v<f.length;v+=1)f[v]&&f[v].m(n,null);e||(l=de(ke.call(null,a,s[12])),e=!0)},p(p,m){if(m[0]&17&&o!==(o=p[0].views[p[4]].name+"")&&K(t,o),m[0]&4113){r=q(p[0].views[p[4]].story);let v;for(v=0;v<r.length;v+=1){const k=ae(p,r,v);f[v]?f[v].p(k,m):(f[v]=ue(k),f[v].c(),f[v].m(n,null))}for(;v<f.length;v+=1)f[v].d(1);f.length=r.length}},d(p){p&&g(i),ge(f,p),e=!1,l()}}}function Ke(s){let i,n,a=s[33].text+"";return{c(){i=N("p"),n=new Q(!1),this.h()},l(o){i=E(o,"P",{});var t=I(i);n=X(t,!1),t.forEach(g),this.h()},h(){n.a=null},m(o,t){M(o,i,t),n.m(a,i)},p(o,t){t[0]&17&&a!==(a=o[33].text+"")&&n.p(a)},d(o){o&&g(i)}}}function Qe(s){let i;function n(t,u){return t[33].stop?Ye:Xe}let a=n(s),o=a(s);return{c(){o.c(),i=O()},l(t){o.l(t),i=O()},m(t,u){o.m(t,u),M(t,i,u)},p(t,u){a===(a=n(t))&&o?o.p(t,u):(o.d(1),o=a(t),o&&(o.c(),o.m(i.parentNode,i)))},d(t){t&&g(i),o.d(t)}}}function Xe(s){let i,n,a=s[33].text+"";return{c(){i=N("h2"),n=new Q(!1),this.h()},l(o){i=E(o,"H2",{class:!0});var t=I(i);n=X(t,!1),t.forEach(g),this.h()},h(){n.a=null,c(i,"class","svelte-7d3ou1")},m(o,t){M(o,i,t),n.m(a,i)},p(o,t){t[0]&17&&a!==(a=o[33].text+"")&&n.p(a)},d(o){o&&g(i)}}}function Ye(s){let i,n,a=s[33].text+"",o,t,u;return{c(){i=N("h2"),n=new Q(!1),this.h()},l(e){i=E(e,"H2",{"data-id":!0,class:!0});var l=I(i);n=X(l,!1),l.forEach(g),this.h()},h(){n.a=null,c(i,"data-id",o=s[33].stop),c(i,"class","svelte-7d3ou1")},m(e,l){M(e,i,l),n.m(a,i),t||(u=de(ke.call(null,i,s[12])),t=!0)},p(e,l){l[0]&17&&a!==(a=e[33].text+"")&&n.p(a),l[0]&17&&o!==(o=e[33].stop)&&c(i,"data-id",o)},d(e){e&&g(i),t=!1,u()}}}function ue(s){let i;function n(t,u){if(t[33].type=="h")return Qe;if(t[33].type=="p")return Ke}let a=n(s),o=a&&a(s);return{c(){o&&o.c(),i=O()},l(t){o&&o.l(t),i=O()},m(t,u){o&&o.m(t,u),M(t,i,u)},p(t,u){a===(a=n(t))&&o?o.p(t,u):(o&&o.d(1),o=a&&a(t),o&&(o.c(),o.m(i.parentNode,i)))},d(t){t&&g(i),o&&o.d(t)}}}function fe(s){let i,n,a=q(Object.values(s[0].maps)),o=[];for(let u=0;u<a.length;u+=1)o[u]=me(ne(s,a,u));const t=u=>w(o[u],1,1,()=>{o[u]=null});return{c(){for(let u=0;u<o.length;u+=1)o[u].c();i=O()},l(u){for(let e=0;e<o.length;e+=1)o[e].l(u);i=O()},m(u,e){for(let l=0;l<o.length;l+=1)o[l]&&o[l].m(u,e);M(u,i,e),n=!0},p(u,e){if(e[0]&3827){a=q(Object.values(u[0].maps));let l;for(l=0;l<a.length;l+=1){const r=ne(u,a,l);o[l]?(o[l].p(r,e),h(o[l],1)):(o[l]=me(r),o[l].c(),h(o[l],1),o[l].m(i.parentNode,i))}for(P(),l=a.length;l<o.length;l+=1)t(l);z()}},i(u){if(!n){for(let e=0;e<a.length;e+=1)h(o[e]);n=!0}},o(u){o=o.filter(Boolean);for(let e=0;e<o.length;e+=1)w(o[e]);n=!1},d(u){u&&g(i),ge(o,u)}}}function pe(s){let i,n,a,o;const t=[ss,es,xe],u=[];function e(l,r){return l[30].type=="shapefile"?0:l[30].type=="tile"?1:l[30].type=="label"?2:-1}return~(i=e(s))&&(n=u[i]=t[i](s)),{c(){n&&n.c(),a=O()},l(l){n&&n.l(l),a=O()},m(l,r){~i&&u[i].m(l,r),M(l,a,r),o=!0},p(l,r){let f=i;i=e(l),i===f?~i&&u[i].p(l,r):(n&&(P(),w(u[f],1,1,()=>{u[f]=null}),z()),~i?(n=u[i],n?n.p(l,r):(n=u[i]=t[i](l),n.c()),h(n,1),n.m(a.parentNode,a)):n=null)},i(l){o||(h(n),o=!0)},o(l){w(n),o=!1},d(l){l&&g(a),~i&&u[i].d(l)}}}function xe(s){let i,n,a,o;const t=[ls,is],u=[];function e(l,r){return l[30].interactive?0:1}return i=e(s),n=u[i]=t[i](s),{c(){n.c(),a=O()},l(l){n.l(l),a=O()},m(l,r){u[i].m(l,r),M(l,a,r),o=!0},p(l,r){let f=i;i=e(l),i===f?u[i].p(l,r):(P(),w(u[f],1,1,()=>{u[f]=null}),z(),n=u[i],n?n.p(l,r):(n=u[i]=t[i](l),n.c()),h(n,1),n.m(a.parentNode,a))},i(l){o||(h(n),o=!0)},o(l){w(n),o=!1},d(l){l&&g(a),u[i].d(l)}}}function es(s){let i,n=s[32],a;const o=()=>s[18](i,n),t=()=>s[18](null,n);let u={urlPath:s[30].urlPath,urlExtension:s[30].urlExtension,projection:s[7],visible:s[6]==null&&s[0].views[s[4]].maps&&s[0].views[s[4]].maps.includes(s[30].id)||s[6]&&s[0].views[s[4]].stops[s[6]].maps&&s[0].views[s[4]].stops[s[6]].maps.includes(s[30].id)};return i=new Ze({props:u}),o(),{c(){C(i.$$.fragment)},l(e){J(i.$$.fragment,e)},m(e,l){S(i,e,l),a=!0},p(e,l){n!==e[32]&&(t(),n=e[32],o());const r={};l[0]&1&&(r.urlPath=e[30].urlPath),l[0]&1&&(r.urlExtension=e[30].urlExtension),l[0]&128&&(r.projection=e[7]),l[0]&81&&(r.visible=e[6]==null&&e[0].views[e[4]].maps&&e[0].views[e[4]].maps.includes(e[30].id)||e[6]&&e[0].views[e[4]].stops[e[6]].maps&&e[0].views[e[4]].stops[e[6]].maps.includes(e[30].id)),i.$set(r)},i(e){a||(h(i.$$.fragment,e),a=!0)},o(e){w(i.$$.fragment,e),a=!1},d(e){t(),L(i,e)}}}function ss(s){let i,n,a,o;const t=[ns,os],u=[];function e(l,r){return l[30].interactive?0:1}return i=e(s),n=u[i]=t[i](s),{c(){n.c(),a=O()},l(l){n.l(l),a=O()},m(l,r){u[i].m(l,r),M(l,a,r),o=!0},p(l,r){let f=i;i=e(l),i===f?u[i].p(l,r):(P(),w(u[f],1,1,()=>{u[f]=null}),z(),n=u[i],n?n.p(l,r):(n=u[i]=t[i](l),n.c()),h(n,1),n.m(a.parentNode,a))},i(l){o||(h(n),o=!0)},o(l){w(n),o=!1},d(l){l&&g(a),u[i].d(l)}}}function is(s){let i,n=s[32],a;const o=()=>s[20](i,n),t=()=>s[20](null,n);let u={activeViewID:s[4],activeEraID:s[5],activeStopID:s[6],path:s[30].path,id:s[30].id,projection:s[7],visible:s[6]==null&&s[0].views[s[4]].maps&&s[0].views[s[4]].maps.includes(s[30].id)||s[6]&&s[0].views[s[4]].stops[s[6]].maps&&s[0].views[s[4]].stops[s[6]].maps.includes(s[30].id),labelField:s[30].labelField,filterOnContext:s[30].filterOnContext,interactive:s[30].interactive};return i=new ce({props:u}),o(),{c(){C(i.$$.fragment)},l(e){J(i.$$.fragment,e)},m(e,l){S(i,e,l),a=!0},p(e,l){n!==e[32]&&(t(),n=e[32],o());const r={};l[0]&16&&(r.activeViewID=e[4]),l[0]&32&&(r.activeEraID=e[5]),l[0]&64&&(r.activeStopID=e[6]),l[0]&1&&(r.path=e[30].path),l[0]&1&&(r.id=e[30].id),l[0]&128&&(r.projection=e[7]),l[0]&81&&(r.visible=e[6]==null&&e[0].views[e[4]].maps&&e[0].views[e[4]].maps.includes(e[30].id)||e[6]&&e[0].views[e[4]].stops[e[6]].maps&&e[0].views[e[4]].stops[e[6]].maps.includes(e[30].id)),l[0]&1&&(r.labelField=e[30].labelField),l[0]&1&&(r.filterOnContext=e[30].filterOnContext),l[0]&1&&(r.interactive=e[30].interactive),i.$set(r)},i(e){a||(h(i.$$.fragment,e),a=!0)},o(e){w(i.$$.fragment,e),a=!1},d(e){t(),L(i,e)}}}function ls(s){let i,n=s[32],a;const o=()=>s[19](i,n),t=()=>s[19](null,n);let u={activeViewID:s[4],activeEraID:s[5],activeStopID:s[6],path:s[30].path,id:s[30].id,projection:s[7],visible:s[6]==null&&s[0].views[s[4]].maps&&s[0].views[s[4]].maps.includes(s[30].id)||s[6]&&s[0].views[s[4]].stops[s[6]].maps&&s[0].views[s[4]].stops[s[6]].maps.includes(s[30].id),labelField:s[30].labelField,filterOnContext:s[30].filterOnContext,interactive:s[30].interactive};return i=new ce({props:u}),o(),i.$on("featureMouseOver",s[9]),i.$on("featureMouseOut",s[10]),i.$on("featureClick",s[11]),{c(){C(i.$$.fragment)},l(e){J(i.$$.fragment,e)},m(e,l){S(i,e,l),a=!0},p(e,l){n!==e[32]&&(t(),n=e[32],o());const r={};l[0]&16&&(r.activeViewID=e[4]),l[0]&32&&(r.activeEraID=e[5]),l[0]&64&&(r.activeStopID=e[6]),l[0]&1&&(r.path=e[30].path),l[0]&1&&(r.id=e[30].id),l[0]&128&&(r.projection=e[7]),l[0]&81&&(r.visible=e[6]==null&&e[0].views[e[4]].maps&&e[0].views[e[4]].maps.includes(e[30].id)||e[6]&&e[0].views[e[4]].stops[e[6]].maps&&e[0].views[e[4]].stops[e[6]].maps.includes(e[30].id)),l[0]&1&&(r.labelField=e[30].labelField),l[0]&1&&(r.filterOnContext=e[30].filterOnContext),l[0]&1&&(r.interactive=e[30].interactive),i.$set(r)},i(e){a||(h(i.$$.fragment,e),a=!0)},o(e){w(i.$$.fragment,e),a=!1},d(e){t(),L(i,e)}}}function os(s){let i,n=s[32],a;const o=()=>s[17](i,n),t=()=>s[17](null,n);let u={activeViewID:s[4],activeEraID:s[5],activeStopID:s[6],url:s[30].url,topoJson:s[30].topoJson,topoJsonObjectsName:s[30].topoJsonObjectsName,geometryType:s[30].geometryType?s[30].geometryType:"polygons",id:s[30].id,projection:s[7],visible:s[6]==null&&s[0].views[s[4]].maps&&s[0].views[s[4]].maps.includes(s[30].id)||s[6]&&s[0].views[s[4]].stops[s[6]].maps&&s[0].views[s[4]].stops[s[6]].maps.includes(s[30].id)};return i=new we({props:u}),o(),{c(){C(i.$$.fragment)},l(e){J(i.$$.fragment,e)},m(e,l){S(i,e,l),a=!0},p(e,l){n!==e[32]&&(t(),n=e[32],o());const r={};l[0]&16&&(r.activeViewID=e[4]),l[0]&32&&(r.activeEraID=e[5]),l[0]&64&&(r.activeStopID=e[6]),l[0]&1&&(r.url=e[30].url),l[0]&1&&(r.topoJson=e[30].topoJson),l[0]&1&&(r.topoJsonObjectsName=e[30].topoJsonObjectsName),l[0]&1&&(r.geometryType=e[30].geometryType?e[30].geometryType:"polygons"),l[0]&1&&(r.id=e[30].id),l[0]&128&&(r.projection=e[7]),l[0]&81&&(r.visible=e[6]==null&&e[0].views[e[4]].maps&&e[0].views[e[4]].maps.includes(e[30].id)||e[6]&&e[0].views[e[4]].stops[e[6]].maps&&e[0].views[e[4]].stops[e[6]].maps.includes(e[30].id)),i.$set(r)},i(e){a||(h(i.$$.fragment,e),a=!0)},o(e){w(i.$$.fragment,e),a=!1},d(e){t(),L(i,e)}}}function ns(s){let i,n=s[32],a;const o=()=>s[16](i,n),t=()=>s[16](null,n);let u={activeViewID:s[4],activeEraID:s[5],activeStopID:s[6],url:s[30].url,topoJson:s[30].topoJson,topoJsonObjectsName:s[30].topoJsonObjectsName,geometryType:s[30].geometryType?s[30].geometryType:"polygons",id:s[30].id,projection:s[7],visible:s[6]==null&&s[0].views[s[4]].maps&&s[0].views[s[4]].maps.includes(s[30].id)||s[6]&&s[0].views[s[4]].stops[s[6]].maps&&s[0].views[s[4]].stops[s[6]].maps.includes(s[30].id),interactive:!0};return i=new we({props:u}),o(),i.$on("featureMouseOver",s[9]),i.$on("featureMouseOut",s[10]),i.$on("featureClick",s[11]),{c(){C(i.$$.fragment)},l(e){J(i.$$.fragment,e)},m(e,l){S(i,e,l),a=!0},p(e,l){n!==e[32]&&(t(),n=e[32],o());const r={};l[0]&16&&(r.activeViewID=e[4]),l[0]&32&&(r.activeEraID=e[5]),l[0]&64&&(r.activeStopID=e[6]),l[0]&1&&(r.url=e[30].url),l[0]&1&&(r.topoJson=e[30].topoJson),l[0]&1&&(r.topoJsonObjectsName=e[30].topoJsonObjectsName),l[0]&1&&(r.geometryType=e[30].geometryType?e[30].geometryType:"polygons"),l[0]&1&&(r.id=e[30].id),l[0]&128&&(r.projection=e[7]),l[0]&81&&(r.visible=e[6]==null&&e[0].views[e[4]].maps&&e[0].views[e[4]].maps.includes(e[30].id)||e[6]&&e[0].views[e[4]].stops[e[6]].maps&&e[0].views[e[4]].stops[e[6]].maps.includes(e[30].id)),i.$set(r)},i(e){a||(h(i.$$.fragment,e),a=!0)},o(e){w(i.$$.fragment,e),a=!1},d(e){t(),L(i,e)}}}function me(s){let i=s[6]==null&&s[0].views[s[4]].maps&&s[0].views[s[4]].maps.includes(s[30].id)||s[6]&&s[0].views[s[4]].stops[s[6]].maps&&s[0].views[s[4]].stops[s[6]].maps.includes(s[30].id),n,a,o=i&&pe(s);return{c(){o&&o.c(),n=O()},l(t){o&&o.l(t),n=O()},m(t,u){o&&o.m(t,u),M(t,n,u),a=!0},p(t,u){u[0]&81&&(i=t[6]==null&&t[0].views[t[4]].maps&&t[0].views[t[4]].maps.includes(t[30].id)||t[6]&&t[0].views[t[4]].stops[t[6]].maps&&t[0].views[t[4]].stops[t[6]].maps.includes(t[30].id)),i?o?(o.p(t,u),u[0]&81&&h(o,1)):(o=pe(t),o.c(),h(o,1),o.m(n.parentNode,n)):o&&(P(),w(o,1,1,()=>{o=null}),z())},i(t){a||(h(o),a=!0)},o(t){w(o),a=!1},d(t){t&&g(n),o&&o.d(t)}}}function as(s){let i,n,a,o,t,u,e,l=s[5]&&te(s),r=s[0].views[s[4]].story&&re(s),f=!s[8]&&fe(s);return{c(){i=N("div"),l&&l.c(),n=T(),r&&r.c(),a=T(),o=ie("svg"),t=ie("g"),f&&f.c(),this.h()},l(p){i=E(p,"DIV",{id:!0,class:!0,style:!0});var m=I(i);l&&l.l(m),n=V(m),r&&r.l(m),a=V(m),o=le(m,"svg",{id:!0,class:!0});var v=I(o);t=le(v,"g",{});var k=I(t);f&&f.l(k),k.forEach(g),v.forEach(g),m.forEach(g),this.h()},h(){c(o,"id","map-svg"),c(o,"class","svelte-7d3ou1"),oe(o,"story",s[0].views[s[4]].story!=null),c(i,"id","map"),c(i,"class",u=`view-${s[4]} era-${s[5]} stop-${s[6]} svelte-7d3ou1`),G(i,"--color-era-urban-industrial",U.colorEraUrbanIndustrial),G(i,"--color-era-pre-1600s",U.colorEraPre1600s),G(i,"--color-era-early-european-settlement",U.colorEraEarlyEuropeanSettlement)},m(p,m){M(p,i,m),l&&l.m(i,null),y(i,n),r&&r.m(i,null),y(i,a),y(i,o),y(o,t),f&&f.m(t,null),s[21](t),s[22](o),e=!0},p(p,m){p[5]?l?l.p(p,m):(l=te(p),l.c(),l.m(i,n)):l&&(l.d(1),l=null),p[0].views[p[4]].story?r?r.p(p,m):(r=re(p),r.c(),r.m(i,a)):r&&(r.d(1),r=null),p[8]?f&&(P(),w(f,1,1,()=>{f=null}),z()):f?(f.p(p,m),m[0]&256&&h(f,1)):(f=fe(p),f.c(),h(f,1),f.m(t,null)),(!e||m[0]&17)&&oe(o,"story",p[0].views[p[4]].story!=null),(!e||m[0]&112&&u!==(u=`view-${p[4]} era-${p[5]} stop-${p[6]} svelte-7d3ou1`))&&c(i,"class",u)},i(p){e||(h(f),e=!0)},o(p){w(f),e=!1},d(p){p&&g(i),l&&l.d(),r&&r.d(),f&&f.d(),s[21](null),s[22](null)}}}const ts=4500;function _e(s){return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{coordinates:[[[s.nwLng,s.nwLat],[s.seLng,s.nwLat],[s.seLng,s.seLat],[s.nwLng,s.seLat],[s.nwLng,s.nwLat]]],type:"Polygon"}}]}}function rs(s,i,n){let{story:a={}}=i;function o(_){console.log("Maps:onChapterMouseOver(event:"+JSON.stringify(_.detail)+")"),e.forEach(b=>{b.onChapterMouseOver&&b.onChapterMouseOver(_)})}function t(_){console.log("Maps:onChapterMouseLeave(event:"+JSON.stringify(_.detail)+")"),e.forEach(b=>{b.onChapterMouseLeave&&b.onChapterMouseLeave(_)})}function u(_){console.log(`Maps:onNavigate(event:${JSON.stringify(_.detail)})`),n(4,v=_.detail.viewID),n(5,k=_.detail.eraID),n(6,$=null),a.views[v].extent&&d(a.views[v].extent)}let e=[],l,r,f,p,m,v=a.intialView,k=null,$=null,F,A=!0;je(()=>{console.log("Maps:onMount()"),f=parseInt(j(l).style("width"),10),p=parseInt(j(l).style("height"),10),console.log(`Map width: ${f}; height: ${p}`),n(7,F=Ge().rotate([74,0]).fitSize([f,p],_e(a.views[a.intialView].extent))),n(8,A=!1)}),m=Ue().on("zoom",B);const H=Te();function d(_){console.log(`Maps:moveMap(extent:${JSON.stringify(_)}`),f=parseInt(j("#map-svg").style("width"),10),p=parseInt(j("#map-svg").style("height"),10),console.log(`Map width: ${f}; height: ${p}`);const b=_e(_);var Le=We().projection(F);const Fe=Le.bounds(b),[[Y,x],[ee,se]]=Fe;j(r).transition().duration(ts).ease(Re).call(m.transform,Ae.translate(f/2,p/2).scale(.9/Math.max((ee-Y)/f,(se-x)/p)).translate(-(Y+ee)/2,-(x+se)/2))}function B(_){const{transform:b}=_;j(r).attr("transform",b),j(r).selectAll("text").attr("font-size",10/b.k)}function Me(_){console.log("Maps:onFeatureMouseOver(event.detail:"+JSON.stringify(_.detail)+")"),H("featureMouseOver",_.detail)}function Oe(_){console.log("Maps:onFeatureMouseOut(event.detail:"+JSON.stringify(_.detail)+")"),H("featureMouseOut",_.detail)}function $e(_){console.log("Maps:onFeatureClick(event.detail:"+JSON.stringify(_.detail)+")"),H("featureClick",_.detail)}function ye(_){console.log(`Maps:onStop(stopID:${_})`),n(6,$=_),_?a.views[v].stops&&a.views[v].stops[$]&&d(a.views[v].stops[$].extent):d(a.views[v].extent)}function Ie(_,b){D[_?"unshift":"push"](()=>{e[b]=_,n(1,e)})}function De(_,b){D[_?"unshift":"push"](()=>{e[b]=_,n(1,e)})}function Ne(_,b){D[_?"unshift":"push"](()=>{e[b]=_,n(1,e)})}function Ee(_,b){D[_?"unshift":"push"](()=>{e[b]=_,n(1,e)})}function Ce(_,b){D[_?"unshift":"push"](()=>{e[b]=_,n(1,e)})}function Je(_){D[_?"unshift":"push"](()=>{r=_,n(3,r)})}function Se(_){D[_?"unshift":"push"](()=>{l=_,n(2,l)})}return s.$$set=_=>{"story"in _&&n(0,a=_.story)},[a,e,l,r,v,k,$,F,A,Me,Oe,$e,ye,o,t,u,Ie,De,Ne,Ee,Ce,Je,Se]}class us extends he{constructor(i){super(),be(this,i,rs,as,ve,{story:0,onChapterMouseOver:13,onChapterMouseLeave:14,onNavigate:15},null,[-1,-1])}get onChapterMouseOver(){return this.$$.ctx[13]}get onChapterMouseLeave(){return this.$$.ctx[14]}get onNavigate(){return this.$$.ctx[15]}}function fs(s){let i,n,a,o,t,u,e,l,r={};i=new qe({props:r}),s[10](i),i.$on("navigate",s[8]);let f={story:R};a=new us({props:f}),s[11](a),a.$on("featureMouseOver",s[3]),a.$on("featureMouseOut",s[4]),a.$on("featureClick",s[7]);let p={eras:R.eras};return t=new Be({props:p}),s[12](t),t.$on("chapterMouseOver",s[5]),t.$on("chapterMouseLeave",s[6]),t.$on("navigate",s[8]),{c(){C(i.$$.fragment),n=T(),C(a.$$.fragment),o=T(),C(t.$$.fragment)},l(m){J(i.$$.fragment,m),n=V(m),J(a.$$.fragment,m),o=V(m),J(t.$$.fragment,m)},m(m,v){S(i,m,v),M(m,n,v),S(a,m,v),M(m,o,v),S(t,m,v),u=!0,e||(l=Ve(window,"popstate",s[9]),e=!0)},p(m,[v]){const k={};i.$set(k);const $={};a.$set($);const F={};t.$set(F)},i(m){u||(h(i.$$.fragment,m),h(a.$$.fragment,m),h(t.$$.fragment,m),u=!0)},o(m){w(i.$$.fragment,m),w(a.$$.fragment,m),w(t.$$.fragment,m),u=!1},d(m){m&&(g(n),g(o)),s[10](null),L(i,m),s[11](null),L(a,m),s[12](null),L(t,m),e=!1,l()}}}function ps(s,i,n){let a;Pe(s,He,d=>n(17,a=d));let o,t,u,e="intro";R.views[e];let l=null;function r(d){console.log("routes/map:onFeatureMouseOver(event.detail:"+JSON.stringify(d.detail)+")"),t.onMapFeatureMouseOver(d)}function f(d){console.log("routes/map:onMapFeatureMouseOut(event.detail:"+JSON.stringify(d.detail)+")"),t.onMapFeatureMouseOut(d)}function p(d){console.log("routes/map:onChapterMouseOver(event.detail:"+JSON.stringify(d.detail)+")"),u.onChapterMouseOver(d)}function m(d){console.log("routes/map:onChapterMouseLeave(event.detail:"+JSON.stringify(d.detail)+")"),u.onChapterMouseLeave(d)}function v(d){console.log("routes/map:onFeatureClick(event.detail:"+JSON.stringify(d.detail)+")"),t.onMapFeatureClick(d)}function k(d,B=!0){console.log(`routes/map:onNavigate(event.detail:${JSON.stringify(d.detail)})`),e=d.detail.viewID,R.views[e],l=d.detail.eraID,l&&R.eras[l],o.navigate(d),u.onNavigate(d),t.onNavigate(d),B&&ze(`#/view/${d.detail.viewID}`,{state:d.detail})}function $(d){d.state&&(console.log(`routes/:popstate:event.state:${JSON.stringify(d.state)}`),console.log(`routes/:popstate:page.state:${JSON.stringify(a.state)}`),d.state["sveltekit:states"].viewID&&k({detail:{...d.state["sveltekit:states"]}},!1))}function F(d){D[d?"unshift":"push"](()=>{o=d,n(0,o)})}function A(d){D[d?"unshift":"push"](()=>{u=d,n(2,u)})}function H(d){D[d?"unshift":"push"](()=>{t=d,n(1,t)})}return[o,t,u,r,f,p,m,v,k,$,F,A,H]}class ws extends he{constructor(i){super(),be(this,i,ps,fs,ve,{})}}export{ws as component};
